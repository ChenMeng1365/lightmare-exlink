<?xml version="1.0" encoding="UTF-8"?>
<module name="openconfig-segment-routing"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:oc-sr="http://openconfig.net/yang/sr"
        xmlns:oc-ext="http://openconfig.net/yang/openconfig-ext"
        xmlns:oc-mplst="http://openconfig.net/yang/mpls-types"
        xmlns:oc-if="http://openconfig.net/yang/interfaces"
        xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
        xmlns:yang="urn:ietf:params:xml:ns:yang:ietf-yang-types">
  <yang-version value="1"/>
  <namespace uri="http://openconfig.net/yang/sr"/>
  <prefix value="oc-sr"/>
  <import module="openconfig-extensions">
    <prefix value="oc-ext"/>
  </import>
  <import module="openconfig-mpls-types">
    <prefix value="oc-mplst"/>
  </import>
  <import module="openconfig-interfaces">
    <prefix value="oc-if"/>
  </import>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="ietf-yang-types">
    <prefix value="yang"/>
  </import>
  <organization>
    <text>OpenConfig working group</text>
  </organization>
  <contact>
    <text>OpenConfig working group
netopenconfig@googlegroups.com</text>
  </contact>
  <description>
    <text>Configuration and operational state parameters relating to the
segment routing. This module defines a number of elements which are
instantiated in multiple places throughout the OpenConfig collection
of models.

Particularly:
 - SRGB+LB dataplane instances - directly instantied by SR.
 - SRGB+LB dataplane reservations - instantiated within MPLS and future SR
                                 dataplanes.
 - SR SID advertisements - instantiated within the relevant IGP.
 - SR-specific counters - instantied within the relevant dataplane.</text>
  </description>
  <oc-ext:openconfig-version semver="0.0.3"/>
  <revision date="2017-01-12">
    <description>
      <text>Minor compliance fixes.</text>
    </description>
    <reference>
      <text>0.0.3</text>
    </reference>
  </revision>
  <revision date="2016-12-15">
    <description>
      <text>Updated revision of SR module.</text>
    </description>
    <reference>
      <text>0.0.2</text>
    </reference>
  </revision>
  <revision date="2016-07-28">
    <description>
      <text>Initial revision of SR module.</text>
    </description>
    <reference>
      <text>0.0.1</text>
    </reference>
  </revision>
  <typedef name="sr-dataplane-type">
    <type name="enumeration">
      <enum name="MPLS">
        <description>
          <text>The entity uses MPLS labels as Segment Identifiers.</text>
        </description>
      </enum>
      <enum name="IPV6">
        <description>
          <text>The entity uses IPv6 prefixes as Segment Identifiers.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Types of data plane that can be used to instantiate a Segment
Routing block of SIDs.</text>
    </description>
  </typedef>
  <typedef name="sr-sid-type">
    <type name="union">
      <type name="oc-mplst:mpls-label"/>
      <type name="inet:ipv6-address-no-zone"/>
    </type>
    <description>
      <text>The defined value of a segment identifier.</text>
    </description>
  </typedef>
  <grouping name="srgb-config">
    <description>
      <text>Configuration parameters relating to the SRGB.</text>
    </description>
    <leaf name="local-id">
      <type name="string"/>
      <description>
        <text>Unique identifier for the segment routing global block on
the local system.</text>
      </description>
    </leaf>
    <leaf name="dataplane-type">
      <type name="sr-dataplane-type"/>
      <description>
        <text>The dataplane being used to instantiate the SRGB. When MPLS is specified
the set of MPLS label blocks that are defined in the mpls-label-blocks
list are used to make up the SRGB. When IPv6 is specified, the set of IPv6
prefixes specified in the ipv6-prefixes list are used.</text>
      </description>
    </leaf>
    <leaf-list name="ipv6-prefixes">
      <when condition="../dataplane-type = 'IPV6'">
        <description>
          <text>Allow IPv6 prefixes to be specified only when the dataplane
realisation of the SRGB is IPv6.</text>
        </description>
      </when>
      <type name="inet:ipv6-prefix"/>
      <description>
        <text>A list of IPv6 prefixes which are to be used for segment routing using
the IPv6 dataplane.</text>
      </description>
    </leaf-list>
  </grouping>
  <grouping name="srgb-state">
    <description>
      <text>Operational state parameters relating to the SRGB.</text>
    </description>
    <leaf name="size">
      <type name="uint32"/>
      <description>
        <text>The total number of SRGB entries that are available within the SRGB.</text>
      </description>
    </leaf>
    <leaf name="used">
      <type name="uint32"/>
      <description>
        <text>The total number of SRGB entries that have already been alocated by
protocols referencing the SRGB.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="srlb-config">
    <description>
      <text>Configuration parameters relating to an SRLB.</text>
    </description>
    <leaf name="local-id">
      <type name="string"/>
      <description>
        <text>A unique local identifier used for the Segment Routing Local Block.
The identifier is used when referencing the SRLB within other
contexts.</text>
      </description>
    </leaf>
    <leaf name="dataplane-type">
      <type name="sr-dataplane-type"/>
      <description>
        <text>The dataplane that is to be used for the Segment Routing Local Block.
When MPLS is specified, the local block corresponds to a block of MPLS
labels; when IPv6 is specified it corresponds to an IPv6 prefix.</text>
      </description>
    </leaf>
    <leaf name="ipv6-prefix">
      <when condition="../dataplane-type = 'IPV6'">
        <description>
          <text>Allow IPv6 prefixes to be specified only when the dataplane
realisation of the SRGB is IPv6.</text>
        </description>
      </when>
      <type name="inet:ipv6-prefix"/>
      <description>
        <text>The IPv6 prefix that is used for the SRLB.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-structural">
    <description>
      <text>Top-level structural grouping defining Segment Routing Global Blocks.</text>
    </description>
    <container name="srgbs">
      <description>
        <text>Configuration and operational state parameters relating to the
SRGBs defined for the system.</text>
      </description>
      <list name="srgb">
        <key value="local-id"/>
        <description>
          <text>A single definition of an SRGB which may comprise of multiple
sets of dataplane addresses (IPv6 addresses, or MPLS labels).</text>
        </description>
        <leaf name="local-id">
          <type name="leafref">
            <path value="../config/local-id"/>
          </type>
          <description>
            <text>A reference to the identifier for the SRGB.</text>
          </description>
        </leaf>
        <container name="config">
          <description>
            <text>Configuration parameters relating to the SRGB.</text>
          </description>
          <uses name="srgb-config"/>
        </container>
        <container name="state">
          <config value="false"/>
          <description>
            <text>State parameters relating to the SRGB.</text>
          </description>
          <uses name="srgb-config"/>
          <uses name="srgb-state"/>
        </container>
      </list>
    </container>
    <container name="srlbs">
      <description>
        <text>Configuration and operational state parameters relating to the
Segment Routing Local Blocks (SRLBs) defined for the system.</text>
      </description>
      <list name="srlb">
        <key value="local-id"/>
        <description>
          <text>A definition of a Segment Routing Local Block, defined to be
a set of Segment Identifiers (specified as MPLS labels or
IPv6 addreses) that are defined for local allocation by the
system. A block may optionally be advertised into an IGP.</text>
        </description>
        <leaf name="local-id">
          <type name="leafref">
            <path value="../config/local-id"/>
          </type>
          <description>
            <text>Reference to the local identifier used for the SRLB.</text>
          </description>
        </leaf>
        <container name="config">
          <description>
            <text>Configuration parameters relating to the SRLB.</text>
          </description>
          <uses name="srlb-config"/>
        </container>
        <container name="state">
          <config value="false"/>
          <description>
            <text>Operational state parmeters relating to the SRLB.</text>
          </description>
          <uses name="srlb-config"/>
        </container>
      </list>
    </container>
  </grouping>
  <grouping name="sr-mpls-top">
    <description>
      <text>Structural grouping defining SR definition within MPLS.</text>
    </description>
    <container name="segment-routing">
      <description>
        <text>MPLS-specific Segment Routing configuration and operational state
parameters</text>
      </description>
      <container name="aggregate-sid-counters">
        <description>
          <text>Per-SID counters aggregated across all interfaces on the local system</text>
        </description>
        <list name="aggregate-sid-counter">
          <key value="mpls-label"/>
          <config value="false"/>
          <description>
            <text>Counters aggregated across all of the interfaces of the local
system corresponding to traffic received or forwarded with a
particular SID</text>
          </description>
          <leaf name="mpls-label">
            <type name="leafref">
              <path value="../state/mpls-label"/>
            </type>
            <description>
              <text>The MPLS label representing the segment identifier</text>
            </description>
          </leaf>
          <container name="state">
            <config value="false"/>
            <description>
              <text>State parameters for per-SID statistics</text>
            </description>
            <uses name="sr-mpls-sid-counters-state"/>
            <uses name="sr-mpls-common-counters"/>
          </container>
        </list>
      </container>
      <container name="interfaces">
        <description>
          <text>Interface related Segment Routing parameters.</text>
        </description>
        <list name="interface">
          <key value="interface-id"/>
          <description>
            <text>Parameters and MPLS-specific configuration relating to Segment
Routing on an interface.</text>
          </description>
          <leaf name="interface-id">
            <type name="leafref">
              <path value="../config/interface-id"/>
            </type>
            <description>
              <text>A reference to the ID for the interface for which SR is
configured</text>
            </description>
          </leaf>
          <container name="config">
            <description>
              <text>MPLS-specific Segment Routing configuration parameters
related to an interface.</text>
            </description>
            <uses name="sr-mpls-interface-config"/>
          </container>
          <container name="state">
            <config value="false"/>
            <description>
              <text>MPLS-specific Segment Routing operational state parameters
related to an interface.</text>
            </description>
            <uses name="sr-mpls-interface-config"/>
            <uses name="sr-mpls-interface-state"/>
          </container>
          <container name="sid-counters">
            <description>
              <text>Per-SID statistics for MPLS</text>
            </description>
            <list name="sid-counter">
              <key value="mpls-label"/>
              <config value="false"/>
              <description>
                <text>Per segment identifier counters for the MPLS dataplane.</text>
              </description>
              <leaf name="mpls-label">
                <type name="leafref">
                  <path value="../state/mpls-label"/>
                </type>
                <description>
                  <text>The MPLS label representing the segment identifier</text>
                </description>
              </leaf>
              <container name="state">
                <config value="false"/>
                <description>
                  <text>State parameters for per-SID statistics</text>
                </description>
                <uses name="sr-mpls-sid-counters-state"/>
                <uses name="sr-mpls-common-counters"/>
              </container>
              <container name="forwarding-classes">
                <description>
                  <text>Per-SID per-forwarding class counters for Segment Routing.</text>
                </description>
                <list name="forwarding-class">
                  <key value="exp"/>
                  <config value="false"/>
                  <description>
                    <text>SID entries for the forwarding class associated with the
referenced MPLS EXP.</text>
                  </description>
                  <leaf name="exp">
                    <type name="leafref">
                      <path value="../state/exp"/>
                    </type>
                    <description>
                      <text>Reference to the value of the EXP bits of the segment
identifier.</text>
                    </description>
                  </leaf>
                  <container name="state">
                    <config value="false"/>
                    <description>
                      <text>Per-SID, per forwarding class counters for Segment Routing
with the MPLS dataplane</text>
                    </description>
                    <uses name="sr-mpls-interface-sid-fc-state"/>
                    <uses name="sr-mpls-common-counters"/>
                  </container>
                </list>
              </container>
            </list>
          </container>
          <uses name="oc-if:interface-ref"/>
        </list>
      </container>
    </container>
  </grouping>
  <grouping name="sr-mpls-interface-config">
    <description>
      <text>MPLS-specific Segment Routing configuration for an interface</text>
    </description>
    <leaf name="interface-id">
      <type name="string"/>
      <description>
        <text>A unique identifier for the interface.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-mpls-interface-state">
    <description>
      <text>MPLS-specific Segment Routing operational state parameters for an
interface</text>
    </description>
    <uses name="sr-mpls-common-counters"/>
  </grouping>
  <grouping name="sr-mpls-interface-sid-fc-state">
    <description>
      <text>Per-SID per forwarding class statistics for SR with the MPLS dataplane</text>
    </description>
    <leaf name="exp">
      <type name="uint8">
        <range value="0..7"/>
      </type>
      <description>
        <text>The value of the MPLS EXP (experimental) or Traffic Class bits that the
SID statistics relate to. Packets received with a MPLS label value
equal to the SID's MPLS label and EXP bits equal to the this value
should be counted towards the associated ingress statistics. Packets
that are forwarded to the destination MPLS label corresponding to the
SID should be counted towards this value. In the egress direction, where
forwarding follows a SID value that requires PHP at the local node,
packets should still be counted towards the egress counters.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-mpls-sid-counters-state">
    <description>
      <text>Per-SID statistics leaves</text>
    </description>
    <leaf name="mpls-label">
      <type name="oc-mplst:mpls-label"/>
      <description>
        <text>The MPLS label used for the segment identifier</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-mpls-common-counters">
    <description>
      <text>Per segment identifier counters used in the model</text>
    </description>
    <leaf name="in-pkts">
      <type name="yang:counter64"/>
      <description>
        <text>A cumulative counter of the packets received within the context
which have matched a label corresponding to an SR Segment Identifier.</text>
      </description>
    </leaf>
    <leaf name="in-octets">
      <type name="yang:counter64"/>
      <description>
        <text>The cumulative counter of the total bytes received within the context
which have matched a label corresponding to an SR Segment Identifier</text>
      </description>
    </leaf>
    <leaf name="out-pkts">
      <type name="yang:counter64"/>
      <description>
        <text>A cumulative counter of the total number of packets transmitted by
the local system within the context which have a label imposed that
corresponds to an Segment Identifier.</text>
      </description>
    </leaf>
    <leaf name="out-octets">
      <type name="yang:counter64"/>
      <description>
        <text>A cumulative counter of the total bytes transmitted by the local
system within the context which have a label imported that
corresponds to an SR Segment Identifier.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-igp-config">
    <description>
      <text>Configuration parameters relating to segment routing within an
IGP.</text>
    </description>
    <leaf name="enabled">
      <type name="boolean"/>
      <description>
        <text>When this leaf is set to true, the segment routing extensions are
utilised within the IGP.</text>
      </description>
    </leaf>
    <leaf name="srgb">
      <type name="leafref">
        <path value="../../../../../../../segment-routing/srgbs/srgb/config/local-id"/>
      </type>
      <description>
        <text>A reference to the Segment Routing Global Block (SRGB) that is
to be used by this IGP instance.</text>
      </description>
    </leaf>
    <leaf name="srlb">
      <type name="leafref">
        <path value="../../../../../../../segment-routing/srlbs/srlb/config/local-id"/>
      </type>
      <description>
        <text>A reference to the Segment Routing Local Block (SRLB) that is to
be advertised by the IGP instance.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-igp-top">
    <description>
      <text>Per-instance configuration and state parameters for Segment Routing
in an IGP.</text>
    </description>
    <container name="segment-routing">
      <description>
        <text>Configuration and operational state relating to segment routing.</text>
      </description>
      <container name="config">
        <description>
          <text>Configuration parameters relating to the configuration of segment
routing for the IGP instance.</text>
        </description>
        <uses name="sr-igp-config"/>
      </container>
      <container name="state">
        <config value="false"/>
        <description>
          <text>Operational state parameters relating to segment routing for the
IGP instance.</text>
        </description>
        <uses name="sr-igp-config"/>
      </container>
    </container>
  </grouping>
  <grouping name="sr-igp-interface-prefix-sid-config">
    <description>
      <text>Configuration parameters relating to an IGP prefix SID advertisement</text>
    </description>
    <leaf name="prefix">
      <type name="inet:ip-prefix"/>
      <description>
        <text>The IP prefix for which the IGP prefix SID should be advertised. The
value specified is a local prefix on the interface which is advertised
into the IGP.</text>
      </description>
    </leaf>
    <leaf name="sid-id">
      <type name="sr-sid-type"/>
      <description>
        <text>The Segment Identifier to be used when advertising the IGP Prefix SID.</text>
      </description>
    </leaf>
    <leaf name="label-options">
      <type name="enumeration">
        <enum name="NO_PHP">
          <description>
            <text>When this value is specified, the penultimate hop must not pop
the Prefix-SID label before forwarding it to the local system.</text>
          </description>
        </enum>
        <enum name="EXPLICIT_NULL">
          <description>
            <text>When set, the penultimate hop must swap the prefix SID for the
relevant explicit null label before forwarding the packet.</text>
          </description>
        </enum>
      </type>
      <description>
        <text>The options associated with the IGP prefix SID for MPLS. The value
of this leaf specifies the option that the SID should be advertised
into the IGP with.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-igp-interface-adjsid-config">
    <description>
      <text>Configuration parameters relating to an Adj-SID on an interface</text>
    </description>
    <leaf name="sid-id">
      <type name="union">
        <type name="sr-sid-type"/>
        <type name="enumeration">
          <enum name="DYNAMIC">
            <description>
              <text>The SID chosen for the Adjacency SID should be dynamically
allocated from the system's dynamic range of Segment
Identifiers. For MPLS, this range should be considered to be
those labels that do not fall within a reserved label block.</text>
            </description>
          </enum>
        </type>
      </type>
      <description>
        <text>The value of the Adj-SID to be advertised. Where a static SID
identifier is specified, this should be advertised directly by the
system. Where the DYNAMIC value is specified, this should be treated
as a dynamically allocated value. When the MPLS data plane is in use
the dynamic value should not fall within a reserved-label-block.</text>
      </description>
    </leaf>
    <leaf name="protection-eligible">
      <type name="boolean"/>
      <default value="true"/>
      <description>
        <text>Whether the Adj-SID should be considered to be eligible for protection
using IP or MPLS FRR during a network failure. When this value is set to
true, the B-flag of the Adj-SID is set to 1, and the local system should
provide FRR paths for the associated label forwarding entry. When it is
set to false, the local system must not provide FRR for the specified
LFIB entry.</text>
      </description>
    </leaf>
    <leaf name="group">
      <type name="boolean"/>
      <default value="false"/>
      <description>
        <text>When set to true, the Adj-SID is indicated to be part of a group, and
the G flag is set to 1 in the corresponding advertisement in the IGP.</text>
      </description>
    </leaf>
    <leaf name="neighbor">
      <type name="inet:ip-address"/>
      <description>
        <text>The remote system on the interface with which the Adj-SID is
associated.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-igp-interface-adjsid-state">
    <description>
      <text>Operational state parameters relating to the adjacency SID for an
interface</text>
    </description>
    <leaf name="allocated-dynamic-local">
      <type name="sr-sid-type"/>
      <description>
        <text>Where an Adjacency SID with a dynamic value is to be allocated by
the system, this leaf reports to the value of the Adj-SID allocated
to this interface.</text>
      </description>
    </leaf>
  </grouping>
  <grouping name="sr-igp-interface-top">
    <description>
      <text>Per-interface configuration and operational state relating to an
interface within the IGP.</text>
    </description>
    <container name="segment-routing">
      <description>
        <text>Configuration and operatioanl state parameters relating to segment
routing for an interface within the IGP.</text>
      </description>
      <container name="prefix-sids">
        <description>
          <text>Configuration and operational state parameters relating to
the advertisement of a segment routing IGP-Prefix SID for this
interface.</text>
        </description>
        <list name="prefix-sid">
          <key value="prefix"/>
          <description>
            <text>An IGP prefix that should have a segment routing IGP-Prefix SID
allocated to it. The value of the SID is specified by the SID ID,
as an absolute value. If the absolute value falls within the SRGB,
the Global flag should be advertised by the system.</text>
          </description>
          <leaf name="prefix">
            <type name="leafref">
              <path value="../config/prefix"/>
            </type>
            <description>
              <text>Reference to the prefix for which the IGP-Prefix SID is to be
advertised</text>
            </description>
          </leaf>
          <container name="config">
            <description>
              <text>Configuration parameters for the IGP Prefix SID.</text>
            </description>
            <uses name="sr-igp-interface-prefix-sid-config"/>
          </container>
          <container name="state">
            <config value="false"/>
            <description>
              <text>Operational state parameters for the IGP-Prefix SID.</text>
            </description>
            <uses name="sr-igp-interface-prefix-sid-config"/>
          </container>
        </list>
      </container>
      <container name="adjacency-sids">
        <description>
          <text>Configuration and operational state parameters relating to
the advertisement of a segment routing adjacency SID for this
interface.</text>
        </description>
        <list name="adjacency-sid">
          <key value="neighbor sid-id"/>
          <description>
            <text>An Adjacency SID to be advertised for the specified interface.
The Adj-SID's identifier (the SID ID) must be unique, with flags
specified indicating the parameters that should be set for the SID.
Where a SID value is specified that is allocated from the SRGB, the
global flag must be set by the system.</text>
          </description>
          <leaf name="sid-id">
            <type name="leafref">
              <path value="../config/sid-id"/>
            </type>
            <description>
              <text>Reference to the segment identifier to be used by the local
system.</text>
            </description>
          </leaf>
          <leaf name="neighbor">
            <type name="leafref">
              <path value="../config/neighbor"/>
            </type>
            <description>
              <text>Reference to the neighbor with which the Adjacency SID is
associated.</text>
            </description>
          </leaf>
          <container name="config">
            <description>
              <text>Configuraton parameters relating to the AdjSID.</text>
            </description>
            <uses name="sr-igp-interface-adjsid-config"/>
          </container>
          <container name="state">
            <config value="false"/>
            <description>
              <text>Operational state parameters relating to the AdjSID.</text>
            </description>
            <uses name="sr-igp-interface-adjsid-config"/>
            <uses name="sr-igp-interface-adjsid-state"/>
          </container>
        </list>
      </container>
    </container>
  </grouping>
  <grouping name="sr-top">
    <description>
      <text>Top level grouping for Segment Routing</text>
    </description>
    <container name="segment-routing">
      <description>
        <text>Configuration and operational state parameters relating to
segment routing.</text>
      </description>
      <uses name="sr-structural"/>
    </container>
  </grouping>
</module>
