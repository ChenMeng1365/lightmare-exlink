<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-mvpn"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:mvpn="urn:huawei:yang:huawei-mvpn"
        xmlns:ifm="urn:huawei:yang:huawei-ifm"
        xmlns:ni="urn:huawei:yang:huawei-network-instance"
        xmlns:l3vpn="urn:huawei:yang:huawei-l3vpn"
        xmlns:pub-type="urn:huawei:yang:huawei-pub-type"
        xmlns:l3mc="urn:huawei:yang:huawei-l3-multicast"
        xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
        xmlns:ext="urn:huawei:yang:huawei-extension"
        xmlns:acl="urn:huawei:yang:huawei-acl"
        xmlns:mpls="urn:huawei:yang:huawei-mpls"
        xmlns:mpls-te="urn:huawei:yang:huawei-mpls-te"
        xmlns:bier="urn:huawei:yang:huawei-bier">
  <namespace uri="urn:huawei:yang:huawei-mvpn"/>
  <prefix value="mvpn"/>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <import module="huawei-network-instance">
    <prefix value="ni"/>
  </import>
  <import module="huawei-l3vpn">
    <prefix value="l3vpn"/>
  </import>
  <import module="huawei-pub-type">
    <prefix value="pub-type"/>
  </import>
  <import module="huawei-l3-multicast">
    <prefix value="l3mc"/>
  </import>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <import module="huawei-acl">
    <prefix value="acl"/>
  </import>
  <import module="huawei-mpls">
    <prefix value="mpls"/>
  </import>
  <import module="huawei-mpls-te">
    <prefix value="mpls-te"/>
  </import>
  <import module="huawei-bier">
    <prefix value="bier"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>A model for Multicast Virtual Private Network (MVPN).</text>
  </description>
  <revision date="2020-02-21">
    <description>
      <text>Modify bier leaf node type to leafref. Add units for some nodes. Modify some restriction for bier node. Modify description. Add dynamic default value for per-item-tunnel-limit.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2020-02-04">
    <description>
      <text>Change rsvp-te-p2mp-template leaf node type to leafref.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-12-18">
    <description>
      <text>Change relative node for bier tunnel.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-11-20">
    <description>
      <text>Change container information to ipmsi-infos.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-05-06">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <ext:task-name value="mvpn"/>
  <typedef name="addr-family-type">
    <type name="enumeration">
      <enum name="ipv4-unicast">
        <value value="1"/>
        <description>
          <text>IPv4 address family.</text>
        </description>
      </enum>
      <enum name="ipv6-unicast">
        <value value="2"/>
        <description>
          <text>IPv6 address family.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Address family.</text>
    </description>
  </typedef>
  <typedef name="signaling-mode">
    <type name="enumeration">
      <enum name="invalid">
        <value value="0"/>
        <description>
          <text>Invalid signaling mode.</text>
        </description>
      </enum>
      <enum name="BGP">
        <value value="2"/>
        <description>
          <text>BGP signaling mode.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>MVPN signal type.</text>
    </description>
  </typedef>
  <typedef name="tunnel-mode">
    <type name="enumeration">
      <enum name="p2mp-te">
        <value value="3"/>
        <description>
          <text>P2MP TE tunnel.</text>
        </description>
      </enum>
      <enum name="p2mp-mldp">
        <value value="4"/>
        <description>
          <text>P2MP mLDP tunnel.</text>
        </description>
      </enum>
      <enum name="bier">
        <value value="7"/>
        <description>
          <text>BIER tunnel.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>MVPN tunnel type.</text>
    </description>
  </typedef>
  <typedef name="auto-discovery-type">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>The A-D mode is disabled.</text>
        </description>
      </enum>
      <enum name="MDT">
        <value value="1"/>
        <description>
          <text>The A-D mode is Multicast Distribution Tree (MDT).</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Auto-Discovery Mode.</text>
    </description>
  </typedef>
  <typedef name="vpn-target-type">
    <type name="enumeration">
      <enum name="export-extcommunity">
        <value value="2"/>
        <description>
          <text>Extended community attribute carried in routes sent from an outbound interface to the destination VPN.</text>
        </description>
      </enum>
      <enum name="import-extcommunity">
        <value value="3"/>
        <description>
          <text>Extended community attribute used to accept routes carrying the specified extended community attribute.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>VPN target type.</text>
    </description>
  </typedef>
  <typedef name="rpt-spt-mode">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>PIM SM shared tree is not supported.</text>
        </description>
      </enum>
      <enum name="spt-mode">
        <value value="1"/>
        <description>
          <text>SPT-only mode.</text>
        </description>
      </enum>
      <enum name="rpt-spt-mode">
        <value value="2"/>
        <description>
          <text>RPT-SPT mode.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The mode of PIM SM shared tree.</text>
    </description>
  </typedef>
  <typedef name="umh-type">
    <type name="enumeration">
      <enum name="unicast">
        <value value="0"/>
        <description>
          <text>Unicast route preferred.</text>
        </description>
      </enum>
      <enum name="highest-ip">
        <value value="1"/>
        <description>
          <text>Highest IP address.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Select upstream multicast hop.</text>
    </description>
  </typedef>
  <typedef name="bier-entropy-mode">
    <type name="enumeration">
      <enum name="sg-hash">
        <value value="1"/>
        <description>
          <text>SG hash entropy mode of MVPN BIER.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>MVPN BIER entropy mode.</text>
    </description>
  </typedef>
  <typedef name="bit-string-length">
    <type name="enumeration">
      <enum name="64-bit">
        <value value="1"/>
        <description>
          <text>64-bit BitString.</text>
        </description>
      </enum>
      <enum name="128-bit">
        <value value="2"/>
        <description>
          <text>128-bit BitString.</text>
        </description>
      </enum>
      <enum name="256-bit">
        <value value="3"/>
        <description>
          <text>256-bit BitString.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Enumerated values of the BitString length.</text>
    </description>
  </typedef>
  <grouping name="spmsis-tunnel-info-type">
    <description>
      <text>S-PMSI tunnel and (S, G) entry state.</text>
    </description>
    <container name="tunnels">
      <config value="false"/>
      <description>
        <text>List of S-PMSI tunnel state.</text>
      </description>
      <list name="tunnel">
        <key value="address"/>
        <description>
          <text>S-PMSI tunnel state.</text>
        </description>
        <leaf name="address">
          <type name="inet:ip-address-no-zone"/>
          <description>
            <text>Tunnel node address.</text>
          </description>
        </leaf>
        <leaf name="role">
          <type name="string">
            <length value="0..15"/>
          </type>
          <description>
            <text>Role of a tunnel node.</text>
          </description>
        </leaf>
      </list>
    </container>
    <container name="sgs">
      <config value="false"/>
      <description>
        <text>List of (S, G) entry state.</text>
      </description>
      <list name="sg">
        <key value="source-addr group-addr"/>
        <description>
          <text>(S, G) entry state.</text>
        </description>
        <leaf name="source-addr">
          <type name="inet:ip-address-no-zone"/>
          <description>
            <text>Source address.</text>
          </description>
        </leaf>
        <leaf name="group-addr">
          <type name="inet:ip-address-no-zone"/>
          <description>
            <text>Group address.</text>
          </description>
        </leaf>
      </list>
    </container>
  </grouping>
  <container name="mvpn">
    <description>
      <text>Configure global MVPN configurations.</text>
    </description>
    <container name="globals">
      <description>
        <text>List of global MVPN configuration.</text>
      </description>
      <list name="global">
        <key value="address-family"/>
        <description>
          <text>Configure global MVPN.</text>
        </description>
        <leaf name="address-family">
          <type name="addr-family-type"/>
          <description>
            <text>IPv4 or IPv6 address family.</text>
          </description>
        </leaf>
        <leaf name="mvpn-id">
          <type name="inet:ip-address-no-zone"/>
          <mandatory value="true"/>
          <description>
            <text>Specify MVPN ID, IP address mode.</text>
          </description>
        </leaf>
        <leaf name="enable-inter-area-segmented">
          <when condition="../address-family='ipv4-unicast'"/>
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable segmented tunnels globally on the ABR.</text>
          </description>
        </leaf>
        <leaf name="apply-explicit-null-label">
          <when condition="../address-family='ipv6-unicast'"/>
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable IPv6 explicit null to apply label.</text>
          </description>
        </leaf>
      </list>
    </container>
  </container>
  <augment target-node="/ni:network-instance/ni:instances/ni:instance/l3vpn:afs/l3vpn:af">
    <when condition="../../ni:name!='_public_' and ((./l3vpn:type='ipv4-unicast' and ../../l3mc:multicast/l3mc:ipv4) or (./l3vpn:type='ipv6-unicast' and ../../l3mc:multicast/l3mc:ipv6))"/>
    <description>
      <text>Add MVPN configuration to the L3VPN module.</text>
    </description>
    <container name="mvpn">
      <description>
        <text>Configure MVPN in the instance.</text>
      </description>
      <leaf name="mvpn-id">
        <when condition="../../l3vpn:type='ipv4-unicast'"/>
        <type name="inet:ip-address-no-zone"/>
        <description>
          <text>Specify MVPN ID, IP address mode.</text>
        </description>
      </leaf>
      <choice name="mvpn-type">
        <description>
          <text>MVPN type.</text>
        </description>
        <case name="ng-mvpn">
          <description>
            <text>NG MVPN.</text>
          </description>
          <container name="ng">
            <must condition="(../../l3vpn:type='ipv4-unicast' and (../mvpn:mvpn-id or /mvpn:mvpn/mvpn:globals/mvpn:global[mvpn:address-family=current()/../../l3vpn:type]/mvpn:mvpn-id)) or (../../l3vpn:type='ipv6-unicast' and /mvpn:mvpn/mvpn:globals/mvpn:global[mvpn:address-family=current()/../../l3vpn:type]/mvpn:mvpn-id)"/>
            <must condition="./is-inter-as='false' or ./inter-area-seg-enable='false'"/>
            <presence value="mvpn enable"/>
            <description>
              <text>Enable/disable NG-MVPN in the instance.</text>
            </description>
            <leaf name="signaling-mode">
              <type name="signaling-mode"/>
              <default value="invalid"/>
              <description>
                <text>Signaling mode.</text>
              </description>
            </leaf>
            <leaf name="is-sender-site">
              <type name="boolean"/>
              <default value="false"/>
              <description>
                <text>Enable/disable the function of specifying the current PE as a sender PE.</text>
              </description>
            </leaf>
            <leaf name="rpt-spt-mode">
              <type name="rpt-spt-mode"/>
              <default value="none"/>
              <description>
                <text>*G mode.</text>
              </description>
            </leaf>
            <leaf name="is-inter-as">
              <type name="boolean"/>
              <default value="false"/>
              <description>
                <text>Enable/disable the function of specifying the current PE as a auto-discovery inter-as PE.</text>
              </description>
            </leaf>
            <leaf name="is-c-multicast-frr">
              <type name="boolean"/>
              <must condition="(../../../l3vpn:type='ipv6-unicast' and ../is-c-multicast-frr='false') or ../../../l3vpn:type='ipv4-unicast'"/>
              <default value="false"/>
              <description>
                <text>Enable/disable FRR.</text>
              </description>
            </leaf>
            <leaf name="frr-flow-based-acl-name">
              <when condition="../../../l3vpn:type='ipv4-unicast' and ../is-c-multicast-frr='true'"/>
              <type name="leafref">
                <path value="/acl:acl/acl:groups/acl:group/acl:identity"/>
              </type>
              <must condition="/acl:acl/acl:groups/acl:group[acl:identity=current()]/acl:type='basic' or /acl:acl/acl:groups/acl:group[acl:identity=current()]/acl:type='advance'"/>
              <description>
                <text>Configure a flow-based IPv4 FRR policy. The value is an integer ranging from 2000 to 3999, or a string of 1 to 64 case-sensitive characters. If no ACL is specified, the switch-group address pool takes effect for all (S, G) entries.</text>
              </description>
            </leaf>
            <leaf name="is-compatible-draft">
              <type name="boolean"/>
              <default value="false"/>
              <description>
                <text>Enable/disable a device to use the packet encapsulation format defined in the draft.</text>
              </description>
            </leaf>
            <leaf name="is-export-msdp">
              <when condition="../../../l3vpn:type='ipv4-unicast'"/>
              <type name="boolean"/>
              <default value="false"/>
              <description>
                <text>Enable/disable a device to export source active to MSDP.</text>
              </description>
            </leaf>
            <leaf name="is-import-msdp">
              <when condition="../../../l3vpn:type='ipv4-unicast'"/>
              <type name="boolean"/>
              <default value="false"/>
              <description>
                <text>Enable/disable a device to import source active from MSDP.</text>
              </description>
            </leaf>
            <leaf name="spmsi-tnl-detect-delay">
              <type name="uint16">
                <range value="3..60"/>
              </type>
              <units name="s"/>
              <default value="5"/>
              <description>
                <text>The delay in tunnel detection.</text>
              </description>
            </leaf>
            <leaf name="rpt-prune-delay">
              <type name="uint16">
                <range value="0..1800"/>
              </type>
              <units name="s"/>
              <default value="60"/>
              <description>
                <text>The delay of RPT pruning.</text>
              </description>
            </leaf>
            <leaf name="inter-area-seg-enable">
              <type name="boolean"/>
              <must condition="(../inter-area-seg-enable='false' and ../../../l3vpn:type='ipv6-unicast') or ../../../l3vpn:type='ipv4-unicast'"/>
              <default value="false"/>
              <description>
                <text>Enable/disable intra-area segmented tunnels.</text>
              </description>
            </leaf>
            <leaf name="umh-select-type">
              <type name="umh-type"/>
              <default value="unicast"/>
              <description>
                <text>Configure UMH select type.</text>
              </description>
            </leaf>
            <leaf name="bier-entropy-mode">
              <when condition="../../../l3vpn:type='ipv4-unicast'"/>
              <type name="bier-entropy-mode"/>
              <description>
                <text>Configure BIER entropy mode.</text>
              </description>
            </leaf>
            <container name="route-targets">
              <description>
                <text>List of MVPN route-targets.</text>
              </description>
              <list name="route-target">
                <key value="rt-type rt-value"/>
                <description>
                  <text>Configure a multicast route-target.</text>
                </description>
                <leaf name="rt-type">
                  <type name="vpn-target-type"/>
                  <description>
                    <text>RT type.</text>
                  </description>
                </leaf>
                <leaf name="rt-value">
                  <type name="string">
                    <length value="3..21"/>
                  </type>
                  <description>
                    <text>The available MVPN target formats are as follows:
- 16-bit AS number:32-bit user-defined number, for example, 1:3. An AS number ranges from 0 to 65535, and a user-defined number ranges from 0 to 4294967295. The AS number and user-defined number cannot be both 0s. That is, a VPN target cannot be 0:0.
- 32-bit IP address:16-bit user-defined number, for example, 192.168.122.15:1. The IP address ranges from 0.0.0.0 to 255.255.255.255, and the user-defined number ranges from 0 to 65535.</text>
                  </description>
                </leaf>
              </list>
            </container>
            <container name="ipmsi-tunnel">
              <must condition="not(../spmsi-tunnels/spmsis/star-star) and not(../spmsi-tunnels/spmsis/star-grps/star-grp)"/>
              <must condition="not(./tunnel-mode) or ./tunnel-mode!='bier' or (./sub-domain-id and ./bsl)"/>
              <presence value="ipmsi-tunnel"/>
              <description>
                <text>Enable/disable I-PMSI in the instance. Default MDT or I-PMSI configuration and operational state information.</text>
              </description>
              <leaf name="tunnel-mode">
                <type name="tunnel-mode"/>
                <description>
                  <text>Tunnel mode.</text>
                </description>
              </leaf>
              <choice name="tunnel-attribute">
                <description>
                  <text>I-PMSI tunnel attributes configuration.</text>
                </description>
                <case name="rsvp-te-p2mp">
                  <when condition="tunnel-mode='p2mp-te'"/>
                  <description>
                    <text>RSVP TE P2MP tunnel.</text>
                  </description>
                  <leaf name="rsvp-te-p2mp-template">
                    <type name="leafref">
                      <path value="/mpls:mpls/mpls-te:te/mpls-te:p2mp-templates/mpls-te:p2mp-template/mpls-te:name"/>
                    </type>
                    <description>
                      <text>RSVP TE P2MP tunnel template.</text>
                    </description>
                  </leaf>
                </case>
                <case name="bier">
                  <when condition="tunnel-mode='bier' and ../../../l3vpn:type='ipv4-unicast'"/>
                  <description>
                    <text>BIER underlay.</text>
                  </description>
                  <leaf name="sub-domain-id">
                    <type name="leafref">
                      <path value="/bier:bier/bier:sub-domains/bier:sub-domain/bier:sub-domain-id"/>
                    </type>
                    <must condition="../../inter-area-seg-enable='false' and ../../is-inter-as='false'"/>
                    <description>
                      <text>Sub-domain ID of BIER.</text>
                    </description>
                  </leaf>
                  <leaf name="bsl">
                    <type name="leafref">
                      <path value="/bier:bier/bier:sub-domains/bier:sub-domain[bier:sub-domain-id=current()/../sub-domain-id]/bier:encapsulations/bier:encapsulation/bier:bsl"/>
                    </type>
                    <description>
                      <text>BitString length of BIER.</text>
                    </description>
                  </leaf>
                </case>
              </choice>
              <container name="ipmsi-infos">
                <config value="false"/>
                <description>
                  <text>I-PMSI state.</text>
                </description>
                <leaf name="tunnel-mode">
                  <type name="tunnel-mode"/>
                  <description>
                    <text>Tunnel mode.</text>
                  </description>
                </leaf>
                <choice name="tunnel-attribute">
                  <description>
                    <text>I-PMSI tunnel attributes configuration.</text>
                  </description>
                  <case name="rsvp-te-p2mp">
                    <description>
                      <text>RSVP TE P2MP tunnel.</text>
                    </description>
                    <leaf name="te-p2mp-id">
                      <type name="pub-type:hex-binary"/>
                      <description>
                        <text>P2MP ID of the P2MP tunnel.</text>
                      </description>
                    </leaf>
                    <leaf name="te-tunnel-id">
                      <type name="uint32"/>
                      <description>
                        <text>ID of the P2MP tunnel.</text>
                      </description>
                    </leaf>
                    <leaf name="te-extend-tunnel-id">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>P2MP extended tunnel interface ID.</text>
                      </description>
                    </leaf>
                  </case>
                  <case name="mldp-p2mp">
                    <description>
                      <text>MLDP P2MP tunnel.</text>
                    </description>
                    <leaf name="ldp-route-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>IP address of the root of a P2MP LSP.</text>
                      </description>
                    </leaf>
                    <leaf name="ldp-lsp-id">
                      <type name="string">
                        <length value="1..255"/>
                      </type>
                      <description>
                        <text>P2MP LSP ID.</text>
                      </description>
                    </leaf>
                  </case>
                </choice>
                <container name="tunnels">
                  <description>
                    <text>List of I-PMSI tunnel state.</text>
                  </description>
                  <list name="tunnel">
                    <key value="address"/>
                    <description>
                      <text>I-PMSI tunnel state.</text>
                    </description>
                    <leaf name="address">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Tunnel node address.</text>
                      </description>
                    </leaf>
                    <leaf name="role">
                      <type name="string">
                        <length value="0..15"/>
                      </type>
                      <description>
                        <text>Role of a tunnel node.</text>
                      </description>
                    </leaf>
                  </list>
                </container>
                <container name="sgs">
                  <description>
                    <text>List of (S, G) entry.</text>
                  </description>
                  <list name="sg">
                    <key value="source-addr group-addr"/>
                    <description>
                      <text>(S, G) entry state.</text>
                    </description>
                    <leaf name="source-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Source address.</text>
                      </description>
                    </leaf>
                    <leaf name="group-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Group address.</text>
                      </description>
                    </leaf>
                  </list>
                </container>
              </container>
            </container>
            <container name="spmsi-tunnels">
              <presence value="spmsi-tunnels"/>
              <description>
                <text>Enable/disable S-PMSI tunnel in the instance. S-PMSI tunnel configuration and operational state information.</text>
              </description>
              <leaf name="switch-delay-time">
                <type name="uint8">
                  <range value="3..60"/>
                </type>
                <units name="s"/>
                <default value="5"/>
                <description>
                  <text>The delay for switching from the I-PMSI to the S-PMSI.</text>
                </description>
              </leaf>
              <leaf name="switch-back-holddown-time">
                <type name="uint16">
                  <range value="0..180"/>
                </type>
                <units name="s"/>
                <default value="60"/>
                <description>
                  <text>The delay for switching back from the S-PMSI to the I-PMSI.</text>
                </description>
              </leaf>
              <leaf name="spmsi-tunnel-withdraw-delay-time">
                <type name="uint16">
                  <range value="5..20"/>
                </type>
                <units name="s"/>
                <default value="5"/>
                <description>
                  <text>The delay for withdrawing the SPMSI.</text>
                </description>
              </leaf>
              <container name="spmsis">
                <description>
                  <text>Configure NG SPMSI switch policy.</text>
                </description>
                <container name="star-star">
                  <when condition="../../../../../l3vpn:type='ipv4-unicast'"/>
                  <must condition="not(../star-grps/star-grp) and not(../../../ipmsi-tunnel)"/>
                  <presence value="spmsi group star-star policy"/>
                  <description>
                    <text>Enable/disable (*, *) S-PMSI swicth policy.</text>
                  </description>
                  <leaf name="tunnel-mode">
                    <type name="tunnel-mode"/>
                    <must condition="../tunnel-mode!='p2mp-te' or ../rsvp-te-p2mp-template"/>
                    <must condition="../tunnel-mode!='bier' or (../sub-domain-id and ../bsl)"/>
                    <mandatory value="true"/>
                    <description>
                      <text>Tunnel mode.</text>
                    </description>
                  </leaf>
                  <choice name="tunnel-attribute">
                    <description>
                      <text>S-PMSI tunnel attributes configuration.</text>
                    </description>
                    <case name="rsvp-te-p2mp">
                      <when condition="tunnel-mode='p2mp-te'"/>
                      <description>
                        <text>RSVP TE P2MP tunnel.</text>
                      </description>
                      <leaf name="rsvp-te-p2mp-template">
                        <type name="leafref">
                          <path value="/mpls:mpls/mpls-te:te/mpls-te:p2mp-templates/mpls-te:p2mp-template/mpls-te:name"/>
                        </type>
                        <description>
                          <text>RSVP TE P2MP tunnel template.</text>
                        </description>
                      </leaf>
                    </case>
                    <case name="bier">
                      <when condition="tunnel-mode='bier'"/>
                      <description>
                        <text>BIER tunnel.</text>
                      </description>
                      <leaf name="sub-domain-id">
                        <type name="leafref">
                          <path value="/bier:bier/bier:sub-domains/bier:sub-domain/bier:sub-domain-id"/>
                        </type>
                        <must condition="../../../../inter-area-seg-enable='false' and ../../../../is-inter-as='false'"/>
                        <description>
                          <text>S-PMSI BIER sub-domain ID.</text>
                        </description>
                      </leaf>
                      <leaf name="bsl">
                        <type name="leafref">
                          <path value="/bier:bier/bier:sub-domains/bier:sub-domain[bier:sub-domain-id=current()/../sub-domain-id]/bier:encapsulations/bier:encapsulation/bier:bsl"/>
                        </type>
                        <description>
                          <text>S-PMSI BIER BitString length.</text>
                        </description>
                      </leaf>
                    </case>
                  </choice>
                </container>
                <container name="star-grps">
                  <when condition="../../../../../l3vpn:type='ipv4-unicast'"/>
                  <description>
                    <text>List of (*, G) S-PMSI switch policys.</text>
                  </description>
                  <list name="star-grp">
                    <must condition="not(../../star-star) and not(../../../../ipmsi-tunnel)"/>
                    <must condition="./tunnel-mode!='p2mp-te' or ./rsvp-te-p2mp-template"/>
                    <must condition="./tunnel-mode!='bier' or (./sub-domain-id and ./bsl)"/>
                    <key value="group-addr group-mask-length"/>
                    <description>
                      <text>Apply (*, G) S-PMSI switch policy.</text>
                    </description>
                    <leaf name="group-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Start address of the IPv4 group address range in private network.</text>
                      </description>
                    </leaf>
                    <leaf name="group-mask-length">
                      <type name="uint8">
                        <range value="4..32"/>
                      </type>
                      <description>
                        <text>Group mask length for the IPv4 group address range in private network.</text>
                      </description>
                    </leaf>
                    <leaf name="tunnel-mode">
                      <type name="tunnel-mode"/>
                      <mandatory value="true"/>
                      <description>
                        <text>Tunnel mode.</text>
                      </description>
                    </leaf>
                    <leaf name="per-item-tunnel-limit">
                      <type name="uint32">
                        <range value="1..8192"/>
                      </type>
                      <ext:dynamic-default>
                        <ext:default-value value="16">
                          <when condition="../tunnel-mode='p2mp-te' or ../tunnel-mode='p2mp-mldp'"/>
                          <description>
                            <text>The default value of p2mp-te or p2mp-mldp tunnel.</text>
                          </description>
                        </ext:default-value>
                        <ext:default-value value="256">
                          <when condition="../tunnel-mode!='p2mp-te' and ../tunnel-mode!='p2mp-mldp'"/>
                          <description>
                            <text>The default value of other tunnel.</text>
                          </description>
                        </ext:default-value>
                      </ext:dynamic-default>
                      <description>
                        <text>Maximum number of S-PMSI tunnels allowed per S-PMSI configuration item per MVPN instance.</text>
                      </description>
                    </leaf>
                    <choice name="tunnel-attribute">
                      <description>
                        <text>S-PMSI tunnel attributes configuration.</text>
                      </description>
                      <case name="rsvp-te-p2mp">
                        <when condition="tunnel-mode='p2mp-te'"/>
                        <description>
                          <text>RSVP TE P2MP tunnel.</text>
                        </description>
                        <leaf name="rsvp-te-p2mp-template">
                          <type name="leafref">
                            <path value="/mpls:mpls/mpls-te:te/mpls-te:p2mp-templates/mpls-te:p2mp-template/mpls-te:name"/>
                          </type>
                          <description>
                            <text>RSVP TE P2MP tunnel template.</text>
                          </description>
                        </leaf>
                      </case>
                      <case name="bier">
                        <when condition="tunnel-mode='bier'"/>
                        <description>
                          <text>BIER tunnel.</text>
                        </description>
                        <leaf name="sub-domain-id">
                          <type name="leafref">
                            <path value="/bier:bier/bier:sub-domains/bier:sub-domain/bier:sub-domain-id"/>
                          </type>
                          <must condition="../../../../../inter-area-seg-enable='false' and ../../../../../is-inter-as='false'"/>
                          <must condition="not(../../star-grp[sub-domain-id!=current()])"/>
                          <description>
                            <text>S-PMSI BIER sub-domain ID.</text>
                          </description>
                        </leaf>
                        <leaf name="bsl">
                          <type name="leafref">
                            <path value="/bier:bier/bier:sub-domains/bier:sub-domain[bier:sub-domain-id=current()/../sub-domain-id]/bier:encapsulations/bier:encapsulation/bier:bsl"/>
                          </type>
                          <must condition="not(../../star-grp[bsl!=current()])"/>
                          <description>
                            <text>S-PMSI BIER BitString length.</text>
                          </description>
                        </leaf>
                      </case>
                    </choice>
                  </list>
                </container>
                <container name="src-grps">
                  <description>
                    <text>List of (S, G) S-PMSI switch policys.</text>
                  </description>
                  <list name="src-grp">
                    <must condition="../../star-star or ../../../../ipmsi-tunnel"/>
                    <must condition="./tunnel-mode!='p2mp-te' or ./rsvp-te-p2mp-template"/>
                    <must condition="./tunnel-mode!='bier' or (./sub-domain-id and ./bsl)"/>
                    <key value="group-addr group-mask-length source-addr source-mask-length"/>
                    <description>
                      <text>Apply (S, G) S-PMSI switch policy.</text>
                    </description>
                    <leaf name="group-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Start address of the IP group address range in private net.</text>
                      </description>
                    </leaf>
                    <leaf name="group-mask-length">
                      <type name="uint8">
                        <range value="4..128"/>
                      </type>
                      <description>
                        <text>Group mask length for the IP group address range in private net.</text>
                      </description>
                    </leaf>
                    <leaf name="source-addr">
                      <type name="inet:ip-address-no-zone"/>
                      <description>
                        <text>Start address of the IP source address range in private net.</text>
                      </description>
                    </leaf>
                    <leaf name="source-mask-length">
                      <type name="uint8">
                        <range value="0..128"/>
                      </type>
                      <description>
                        <text>Source mask length for the IP source address range in private net.</text>
                      </description>
                    </leaf>
                    <leaf name="tunnel-mode">
                      <type name="tunnel-mode"/>
                      <must condition="(../tunnel-mode!='p2mp-te' and ../tunnel-mode!='p2mp-mldp') or (../../../star-star/tunnel-mode='p2mp-te' or ../../../star-star/tunnel-mode='p2mp-mldp' or ../../../../../ipmsi-tunnel/tunnel-mode='p2mp-te' or ../../../../../ipmsi-tunnel/tunnel-mode='p2mp-mldp')"/>
                      <must condition="(../tunnel-mode!='bier') or ((../../../star-star/tunnel-mode and ../../../star-star/tunnel-mode='bier') or (../../../../../ipmsi-tunnel/tunnel-mode and ../../../../../ipmsi-tunnel/tunnel-mode='bier'))"/>
                      <mandatory value="true"/>
                      <description>
                        <text>Tunnel mode.</text>
                      </description>
                    </leaf>
                    <leaf name="switch-threshold">
                      <type name="uint32">
                        <range value="0..4194304"/>
                      </type>
                      <units name="kbit/s"/>
                      <default value="0"/>
                      <description>
                        <text>Multicast packet rate threshold for triggering the switching from the I-PMSI to the S-PMSI.</text>
                      </description>
                    </leaf>
                    <leaf name="per-item-tunnel-limit">
                      <type name="uint32">
                        <range value="1..8192"/>
                      </type>
                      <ext:dynamic-default>
                        <ext:default-value value="16">
                          <when condition="../tunnel-mode='p2mp-te' or ../tunnel-mode='p2mp-mldp'"/>
                          <description>
                            <text>The default value of p2mp-te or p2mp-mldp tunnel.</text>
                          </description>
                        </ext:default-value>
                        <ext:default-value value="256">
                          <when condition="../tunnel-mode!='p2mp-te' and ../tunnel-mode!='p2mp-mldp'"/>
                          <description>
                            <text>The default value of other tunnel.</text>
                          </description>
                        </ext:default-value>
                      </ext:dynamic-default>
                      <description>
                        <text>Maximum number of S-PMSI tunnels allowed per S-PMSI configuration item per MVPN instance.</text>
                      </description>
                    </leaf>
                    <choice name="tunnel-attribute">
                      <description>
                        <text>S-PMSI tunnel attributes configuration.</text>
                      </description>
                      <case name="rsvp-te-p2mp">
                        <when condition="tunnel-mode='p2mp-te'"/>
                        <description>
                          <text>RSVP TE P2MP tunnel.</text>
                        </description>
                        <leaf name="rsvp-te-p2mp-template">
                          <type name="leafref">
                            <path value="/mpls:mpls/mpls-te:te/mpls-te:p2mp-templates/mpls-te:p2mp-template/mpls-te:name"/>
                          </type>
                          <description>
                            <text>RSVP TE P2MP tunnel template.</text>
                          </description>
                        </leaf>
                      </case>
                      <case name="bier">
                        <when condition="tunnel-mode='bier' and ../../../../../../l3vpn:type='ipv4-unicast'"/>
                        <description>
                          <text>BIER tunnel.</text>
                        </description>
                        <leaf name="sub-domain-id">
                          <type name="leafref">
                            <path value="/bier:bier/bier:sub-domains/bier:sub-domain/bier:sub-domain-id"/>
                          </type>
                          <must condition="../../../../../inter-area-seg-enable='false' and ../../../../../is-inter-as='false'"/>
                          <must condition="../../../star-star[sub-domain-id=current()] or ../../../../../ipmsi-tunnel[sub-domain-id=current()]"/>
                          <description>
                            <text>S-PMSI BIER sub-domain ID.</text>
                          </description>
                        </leaf>
                        <leaf name="bsl">
                          <type name="leafref">
                            <path value="/bier:bier/bier:sub-domains/bier:sub-domain[bier:sub-domain-id=current()/../sub-domain-id]/bier:encapsulations/bier:encapsulation/bier:bsl"/>
                          </type>
                          <must condition="../../../star-star[bsl=current()] or ../../../../../ipmsi-tunnel[bsl=current()]"/>
                          <description>
                            <text>S-PMSI BIER BitString length.</text>
                          </description>
                        </leaf>
                      </case>
                    </choice>
                  </list>
                </container>
              </container>
            </container>
            <container name="spmsis">
              <config value="false"/>
              <description>
                <text>Operational state of S-PMSI.</text>
              </description>
              <container name="te-tunnels">
                <description>
                  <text>List of S-PMSI TE tunnel state.</text>
                </description>
                <list name="te-tunnel">
                  <key value="te-p2mp-id te-tunnel-id te-extend-tunnel-id"/>
                  <description>
                    <text>S-PMSI TE tunnel state.</text>
                  </description>
                  <leaf name="te-p2mp-id">
                    <type name="pub-type:hex-binary"/>
                    <description>
                      <text>P2MP ID of the P2MP tunnel.</text>
                    </description>
                  </leaf>
                  <leaf name="te-tunnel-id">
                    <type name="uint32"/>
                    <description>
                      <text>ID of the P2MP tunnel.</text>
                    </description>
                  </leaf>
                  <leaf name="te-extend-tunnel-id">
                    <type name="inet:ip-address-no-zone"/>
                    <description>
                      <text>P2MP extended tunnel interface ID.</text>
                    </description>
                  </leaf>
                  <uses name="spmsis-tunnel-info-type"/>
                </list>
              </container>
              <container name="ldp-tunnels">
                <description>
                  <text>List of S-PMSI LDP tunnel state.</text>
                </description>
                <list name="ldp-tunnel">
                  <key value="ldp-route-addr opaque-value"/>
                  <description>
                    <text>S-PMSI LDP tunnel state.</text>
                  </description>
                  <leaf name="ldp-route-addr">
                    <type name="inet:ip-address-no-zone"/>
                    <description>
                      <text>IP address of the root of a P2MP LSP.</text>
                    </description>
                  </leaf>
                  <leaf name="opaque-value">
                    <type name="string">
                      <length value="1..255"/>
                    </type>
                    <description>
                      <text>P2MP LSP ID.</text>
                    </description>
                  </leaf>
                  <uses name="spmsis-tunnel-info-type"/>
                </list>
              </container>
            </container>
          </container>
        </case>
        <case name="rosen-mvpn">
          <description>
            <text>Rosen MVPN.</text>
          </description>
          <container name="rosen">
            <description>
              <text>Configure rosen MVPN.</text>
            </description>
            <container name="share-group">
              <presence value="config share group"/>
              <description>
                <text>Enable/disable multicast-domain share-group.</text>
              </description>
              <leaf name="address">
                <type name="inet:ip-address-no-zone"/>
                <mandatory value="true"/>
                <description>
                  <text>Default MDT or I-PMSI group address for SM mode.</text>
                </description>
              </leaf>
              <leaf name="mtunnel-number">
                <type name="uint32">
                  <range value="0..4095"/>
                </type>
                <must condition="(../ip-address and ../ip-mask-length) or not(../ip-address or ../ip-mask-length)"/>
                <mandatory value="true"/>
                <description>
                  <text>MTI ID.</text>
                </description>
              </leaf>
              <choice name="mtunnel-ip-configuration">
                <description>
                  <text>Mtunnel IP configuration.</text>
                </description>
                <case name="use-exist-interface-ip">
                  <description>
                    <text>Use IP of an exist interface.</text>
                  </description>
                  <leaf name="unnumbered-if-name">
                    <type name="leafref">
                      <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
                    </type>
                    <must condition="../../../../../../ni:name=/ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:vrf-name"/>
                    <description>
                      <text>Interface whose IP address is used as the default IP address of an MTI.</text>
                    </description>
                  </leaf>
                </case>
                <case name="specify-mtunnel-ip">
                  <description>
                    <text>Specify an IP.</text>
                  </description>
                  <leaf name="ip-address">
                    <type name="inet:ipv4-address-no-zone"/>
                    <description>
                      <text>MTI IP address.</text>
                    </description>
                  </leaf>
                  <leaf name="ip-mask-length">
                    <type name="uint32">
                      <range value="0..32"/>
                    </type>
                    <description>
                      <text>Mask length of the MTI IP address.</text>
                    </description>
                  </leaf>
                </case>
              </choice>
            </container>
            <container name="attributes">
              <description>
                <text>Configure rosen MVPN attributes.</text>
              </description>
              <leaf name="auto-discovery-mode">
                <when condition="../../mvpn:share-group"/>
                <type name="auto-discovery-type"/>
                <default value="none"/>
                <description>
                  <text>A-D mode.</text>
                </description>
              </leaf>
              <leaf name="is-switch-without-register">
                <when condition="../../mvpn:share-group"/>
                <type name="boolean"/>
                <default value="false"/>
                <description>
                  <text>Enable/disable the source PE from sending register packets to the RP to establish the SPT on the public network before the switch-group address is used to encapsulate VPN data.</text>
                </description>
              </leaf>
              <leaf name="source-interface-name">
                <type name="leafref">
                  <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
                </type>
                <description>
                  <text>Name of the public network interface whose IP address is used as the default IP address of an MTI.</text>
                </description>
              </leaf>
            </container>
          </container>
        </case>
      </choice>
    </container>
  </augment>
</module>
