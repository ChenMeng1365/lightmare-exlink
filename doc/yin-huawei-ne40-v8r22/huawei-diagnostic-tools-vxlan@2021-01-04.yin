<?xml version="1.0" encoding="UTF-8"?>
<submodule name="huawei-diagnostic-tools-vxlan"
           xmlns="urn:ietf:params:xml:ns:yang:yin:1"
           xmlns:diagnostic-tools="urn:huawei:yang:huawei-diagnostic-tools"
           xmlns:pub-type="urn:huawei:yang:huawei-pub-type"
           xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
           xmlns:ext="urn:huawei:yang:huawei-extension">
  <yang-version value="1"/>
  <belongs-to module="huawei-diagnostic-tools">
    <prefix value="diagnostic-tools"/>
  </belongs-to>
  <import module="huawei-pub-type">
    <prefix value="pub-type"/>
  </import>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <include module="huawei-diagnostic-tools-type"/>
  <include module="huawei-diagnostic-tools-common"/>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Vxlan diagnosis tool.</text>
  </description>
  <revision date="2021-01-04">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <grouping name="vxlan-ping-trace-result-type">
    <description>
      <text>Test result.</text>
    </description>
    <container name="ping-results">
      <config value="false"/>
      <description>
        <text>List of VXLAN ping test results.</text>
      </description>
      <list name="ping-result">
        <key value="test-name"/>
        <config value="false"/>
        <description>
          <text>Statistics of VXLAN ping test result.</text>
        </description>
        <leaf name="test-name">
          <type name="string">
            <length value="1..32"/>
          </type>
          <description>
            <text>Test name.</text>
          </description>
        </leaf>
        <leaf name="packet-send">
          <type name="uint32"/>
          <description>
            <text>Total number of sent packets.</text>
          </description>
        </leaf>
        <leaf name="packet-recv">
          <type name="uint32"/>
          <description>
            <text>Total number of received packets.</text>
          </description>
        </leaf>
        <leaf name="loss-ratio">
          <type name="pub-type:percent"/>
          <description>
            <text>Packet loss ratio of a test.</text>
          </description>
        </leaf>
        <leaf name="rtt-min">
          <type name="uint32"/>
          <units name="ms"/>
          <description>
            <text>Minimum RTT of all test packets.</text>
          </description>
        </leaf>
        <leaf name="rtt-max">
          <type name="uint32"/>
          <units name="ms"/>
          <description>
            <text>Maximum RTT of all test packets.</text>
          </description>
        </leaf>
        <leaf name="rtt-average">
          <type name="uint32"/>
          <units name="ms"/>
          <description>
            <text>Average RTT of all test packets.</text>
          </description>
        </leaf>
        <leaf name="status">
          <type name="dgntl-test-status-type"/>
          <description>
            <text>Test status (processing or finished).</text>
          </description>
        </leaf>
        <container name="probes">
          <description>
            <text>List of VXLAN ping results of all packets in a test.</text>
          </description>
          <list name="probe">
            <key value="index"/>
            <description>
              <text>Statistics of probe result of a single packet in a VXLAN ping test.</text>
            </description>
            <leaf name="index">
              <type name="uint32"/>
              <description>
                <text>Serial number of a test packet received.</text>
              </description>
            </leaf>
            <leaf name="replier">
              <type name="inet:ip-address-no-zone"/>
              <description>
                <text>IPv4/IPv6 reply address in a received response packet.</text>
              </description>
            </leaf>
            <leaf name="packet-size">
              <type name="uint32"/>
              <description>
                <text>Number of bytes in a received response packet.</text>
              </description>
            </leaf>
            <leaf name="rtt">
              <type name="uint32"/>
              <units name="ms"/>
              <description>
                <text>RTT of test packet.</text>
              </description>
            </leaf>
            <leaf name="result-type">
              <type name="probe-result-type"/>
              <description>
                <text>Result of sent packet (success or timeout or failed).</text>
              </description>
            </leaf>
            <leaf name="is-delete">
              <type name="boolean"/>
              <ext:support-filter value="true"/>
              <description>
                <text>Enable/disable the function of deleting test results.</text>
              </description>
            </leaf>
          </list>
        </container>
      </list>
    </container>
    <container name="trace-results">
      <config value="false"/>
      <description>
        <text>List of VXLAN trace test results.</text>
      </description>
      <list name="trace-result">
        <key value="test-name"/>
        <config value="false"/>
        <description>
          <text>Statistics of VXLAN trace test result.</text>
        </description>
        <leaf name="test-name">
          <type name="string">
            <length value="1..32"/>
          </type>
          <description>
            <text>Test name.</text>
          </description>
        </leaf>
        <leaf name="status">
          <type name="dgntl-test-status-type"/>
          <description>
            <text>Test status (processing or finished).</text>
          </description>
        </leaf>
        <container name="hops">
          <description>
            <text>List of tracert results of all packets in a test.</text>
          </description>
          <list name="hop">
            <key value="hop-index"/>
            <description>
              <text>Statistics of the response result of a single packet in a VXLAN tracert test.</text>
            </description>
            <leaf name="hop-index">
              <type name="uint32"/>
              <description>
                <text>Serial number of a hop in the test path.</text>
              </description>
            </leaf>
            <leaf name="ttl">
              <type name="uint8">
                <range value="1..255"/>
              </type>
              <description>
                <text>TTL of received response packet.</text>
              </description>
            </leaf>
            <leaf name="replier">
              <type name="inet:ipv4-address-no-zone"/>
              <description>
                <text>IPv4 destination address of the related hop in a test.</text>
              </description>
            </leaf>
            <leaf name="rtt">
              <type name="uint32"/>
              <units name="ms"/>
              <description>
                <text>RTT of test packet.</text>
              </description>
            </leaf>
            <leaf name="ingress-port">
              <type name="string">
                <length value="1..64"/>
              </type>
              <description>
                <text>Inbound interface.</text>
              </description>
            </leaf>
            <leaf name="egress-port">
              <type name="string">
                <length value="1..64"/>
              </type>
              <description>
                <text>Outbound interface.</text>
              </description>
            </leaf>
            <leaf name="result-type">
              <type name="probe-result-type"/>
              <description>
                <text>Result of sent packet (success or timeout or failed).</text>
              </description>
            </leaf>
            <leaf name="is-delete">
              <type name="boolean"/>
              <ext:support-filter value="true"/>
              <description>
                <text>Enable/disable the function of deleting test results.</text>
              </description>
            </leaf>
          </list>
        </container>
      </list>
    </container>
  </grouping>
  <rpc name="vxlan-start-ping">
    <description>
      <text>Start VXLAN ping.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:ping-results"/>
    <input>
      <leaf name="test-name">
        <type name="string">
          <length value="1..32"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
      <leaf name="vni">
        <type name="uint32">
          <range value="1..16777215"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>The ID of the VNI.</text>
        </description>
      </leaf>
      <leaf name="source-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The source address of the NVE interface.</text>
        </description>
      </leaf>
      <leaf name="peer-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The address of the remote NVE.</text>
        </description>
      </leaf>
      <leaf name="udp-port">
        <type name="uint16">
          <range value="1..65535"/>
        </type>
        <description>
          <text>Destination UDP port number.</text>
        </description>
      </leaf>
      <leaf name="inner-source-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <description>
          <text>The source address of the inner packet.</text>
        </description>
      </leaf>
      <leaf name="packet-count">
        <type name="uint32">
          <range value="1..4294967295"/>
        </type>
        <default value="5"/>
        <description>
          <text>Number of sent packets.</text>
        </description>
      </leaf>
      <leaf name="interval">
        <type name="uint32">
          <range value="1..10000"/>
        </type>
        <units name="ms"/>
        <default value="500"/>
        <description>
          <text>Interval for sending test packets.</text>
        </description>
      </leaf>
      <leaf name="reply-mode">
        <type name="vxlan-reply-mode"/>
        <default value="udp"/>
        <description>
          <text>Specify the reply mode of the test packets in a VXLAN ping test.</text>
        </description>
      </leaf>
      <leaf name="timeout">
        <type name="uint32">
          <range value="0..65535"/>
        </type>
        <units name="ms"/>
        <default value="2000"/>
        <description>
          <text>Time taken to wait for the response packets after detection packets are sent. If no response packet is received within the timeout period, the system considers that the test packet times out.</text>
        </description>
      </leaf>
      <choice name="load-balance">
        <description>
          <text>Load balance.</text>
        </description>
        <case name="vxlan-port">
          <description>
            <text>VXLAN port.</text>
          </description>
          <leaf name="vxlan-source-port">
            <type name="uint16">
              <range value="49152..65535"/>
            </type>
            <description>
              <text>VXLAN source port for load balance.</text>
            </description>
          </leaf>
          <leaf name="vxlan-end-source-port">
            <type name="uint16">
              <range value="49152..65535"/>
            </type>
            <description>
              <text>VXLAN end source port for load balance.</text>
            </description>
          </leaf>
        </case>
        <case name="inner-packet">
          <description>
            <text>Inner packet information.</text>
          </description>
          <leaf name="source-address">
            <type name="inet:ipv4-address-no-zone"/>
            <description>
              <text>The IPv4 source address of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-address">
            <type name="inet:ipv4-address-no-zone"/>
            <description>
              <text>The IPv4 destination address of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="protocol">
            <type name="uint8">
              <range value="1..255"/>
            </type>
            <description>
              <text>The protocol of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="source-port">
            <type name="uint16">
              <range value="1..65535"/>
            </type>
            <description>
              <text>The source port of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-port">
            <type name="uint16">
              <range value="1..65535"/>
            </type>
            <description>
              <text>The destination port of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="source-mac">
            <type name="pub-type:mac-address"/>
            <description>
              <text>The source MAC of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-mac">
            <type name="pub-type:mac-address"/>
            <description>
              <text>The destination MAC of the user packet for load balance.</text>
            </description>
          </leaf>
        </case>
      </choice>
    </input>
  </rpc>
  <rpc name="vxlan-stop-ping">
    <description>
      <text>Stop VXLAN ping.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:ping-results"/>
    <input>
      <leaf name="test-name">
        <type name="leafref">
          <path value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:ping-results/diagnostic-tools:ping-result/diagnostic-tools:test-name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="vxlan-delete-ping">
    <description>
      <text>Delete VXLAN ping.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:ping-results"/>
    <input>
      <leaf name="test-name">
        <type name="leafref">
          <path value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:ping-results/diagnostic-tools:ping-result/diagnostic-tools:test-name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="vxlan-start-trace">
    <description>
      <text>Start VXLAN trace.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:trace-results"/>
    <input>
      <leaf name="test-name">
        <type name="string">
          <length value="1..32"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
      <leaf name="vni">
        <type name="uint32">
          <range value="1..16777215"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>The ID of the VNI.</text>
        </description>
      </leaf>
      <leaf name="source-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The source address of the NVE interface.</text>
        </description>
      </leaf>
      <leaf name="peer-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The address of the remote NVE.</text>
        </description>
      </leaf>
      <leaf name="udp-port">
        <type name="uint16">
          <range value="1..65535"/>
        </type>
        <description>
          <text>Destination UDP port number.</text>
        </description>
      </leaf>
      <leaf name="inner-source-addr">
        <type name="inet:ipv4-address-no-zone"/>
        <description>
          <text>The source address of the inner packet.</text>
        </description>
      </leaf>
      <leaf name="reply-mode">
        <type name="vxlan-reply-mode"/>
        <default value="udp"/>
        <description>
          <text>Specify the reply mode of the test packets in a VXLAN trace test.</text>
        </description>
      </leaf>
      <leaf name="timeout">
        <type name="uint32">
          <range value="0..65535"/>
        </type>
        <units name="ms"/>
        <default value="2000"/>
        <description>
          <text>Time taken to wait for the response packets after detection packets are sent. If no response packet is received within the timeout period, the system considers that the test packet times out.</text>
        </description>
      </leaf>
      <leaf name="max-ttl">
        <type name="uint8">
          <range value="1..255"/>
        </type>
        <default value="30"/>
        <description>
          <text>Max TTL of test packets.</text>
        </description>
      </leaf>
      <leaf name="ttl-mode">
        <type name="ttl-mode-type"/>
        <default value="uniform"/>
        <description>
          <text>TTL mode.</text>
        </description>
      </leaf>
      <choice name="load-balance">
        <description>
          <text>Load balance.</text>
        </description>
        <case name="vxlan-port">
          <description>
            <text>VXLAN port.</text>
          </description>
          <leaf name="vxlan-source-port">
            <type name="uint16">
              <range value="49152..65535"/>
            </type>
            <description>
              <text>VXLAN source port for load balance.</text>
            </description>
          </leaf>
        </case>
        <case name="inner-packet">
          <description>
            <text>Inner packet information.</text>
          </description>
          <leaf name="source-address">
            <type name="inet:ipv4-address-no-zone"/>
            <description>
              <text>The IPv4 source address of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-address">
            <type name="inet:ipv4-address-no-zone"/>
            <description>
              <text>The IPv4 destination address of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="protocol">
            <type name="uint8">
              <range value="1..255"/>
            </type>
            <description>
              <text>The protocol of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="source-port">
            <type name="uint16">
              <range value="1..65535"/>
            </type>
            <description>
              <text>The source port of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-port">
            <type name="uint16">
              <range value="1..65535"/>
            </type>
            <description>
              <text>The destination port of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="source-mac">
            <type name="pub-type:mac-address"/>
            <description>
              <text>The source MAC of the user packet for load balance.</text>
            </description>
          </leaf>
          <leaf name="destination-mac">
            <type name="pub-type:mac-address"/>
            <description>
              <text>The destination MAC of the user packet for load balance.</text>
            </description>
          </leaf>
        </case>
      </choice>
    </input>
  </rpc>
  <rpc name="vxlan-stop-trace">
    <description>
      <text>Stop VXLAN trace.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:trace-results"/>
    <input>
      <leaf name="test-name">
        <type name="leafref">
          <path value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:trace-results/diagnostic-tools:trace-result/diagnostic-tools:test-name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="vxlan-delete-trace">
    <description>
      <text>Delete VXLAN trace.</text>
    </description>
    <ext:node-ref value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:trace-results"/>
    <input>
      <leaf name="test-name">
        <type name="leafref">
          <path value="/diagnostic-tools:diagnostic-tools/diagnostic-tools:vxlan/diagnostic-tools:trace-results/diagnostic-tools:trace-result/diagnostic-tools:test-name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Test name.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <augment target-node="/diagnostic-tools:diagnostic-tools">
    <description>
      <text>List of VXLAN tests.</text>
    </description>
    <container name="vxlan">
      <config value="false"/>
      <description>
        <text>Statistics of VXLAN tests.</text>
      </description>
      <uses name="vxlan-ping-trace-result-type"/>
    </container>
  </augment>
</submodule>
