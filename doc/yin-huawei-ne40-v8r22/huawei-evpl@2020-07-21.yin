<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-evpl"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:evpl="urn:huawei:yang:huawei-evpl"
        xmlns:ifm="urn:huawei:yang:huawei-ifm"
        xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
        xmlns:ext="urn:huawei:yang:huawei-extension">
  <namespace uri="urn:huawei:yang:huawei-evpl"/>
  <prefix value="evpl"/>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Management of Ethernet virtual private line.</text>
  </description>
  <revision date="2020-07-21">
    <description>
      <text>Add node ignore-ac-state.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-03-01">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <typedef name="evpl-mode">
    <type name="enumeration">
      <enum name="vxlan-mode">
        <value value="0"/>
        <description>
          <text>VXLAN mode.</text>
        </description>
      </enum>
      <enum name="mpls-mode">
        <value value="1"/>
        <status value="deprecated"/>
        <description>
          <text>MPLS mode.</text>
        </description>
      </enum>
      <enum name="srv6-mode">
        <value value="2"/>
        <status value="deprecated"/>
        <description>
          <text>SRv6 mode.</text>
        </description>
      </enum>
      <enum name="none">
        <value value="3"/>
        <description>
          <text>None mode.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The mode of EVPL instance.</text>
    </description>
  </typedef>
  <ext:task-name value="evpl"/>
  <container name="evpl">
    <description>
      <text>Management of EVPL.</text>
    </description>
    <container name="instances">
      <description>
        <text>List of EVPL instances.</text>
      </description>
      <list name="instance">
        <key value="id"/>
        <description>
          <text>Configure attribute of EVPL instance.</text>
        </description>
        <leaf name="id">
          <type name="uint32">
            <range value="1..16777215"/>
          </type>
          <description>
            <text>The identification of the EVPL instance.</text>
          </description>
        </leaf>
        <leaf name="mode">
          <type name="evpl-mode"/>
          <ext:operation-exclude value="update"/>
          <mandatory value="true"/>
          <description>
            <text>The mode of the EVPL instance, that not support modification.</text>
          </description>
        </leaf>
        <container name="interfaces">
          <when condition="(../mode != 'vxlan-mode')"/>
          <description>
            <text>List of service interfaces that a EVPL instance corresponds.</text>
          </description>
          <list name="interface">
            <key value="name"/>
            <max-elements value="1"/>
            <description>
              <text>Configure the service interface that a EVPL instance corresponds.</text>
            </description>
            <leaf name="name">
              <type name="leafref">
                <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
              </type>
              <must condition="(/ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:type = 'PW-VE' and /ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:class != 'main-interface') or (/ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:type != 'PW-VE')"/>
              <description>
                <text>The name of interface.</text>
              </description>
            </leaf>
            <leaf name="ignore-ac-state">
              <type name="boolean"/>
              <must condition="(../ignore-ac-state='true' and /ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()/../name]/ifm:type != 'PW-VE') or (../ignore-ac-state='false')"/>
              <default value="false"/>
              <description>
                <text>Enable/disable ignore the attachment circuit status on an interface.</text>
              </description>
            </leaf>
          </list>
        </container>
        <container name="peers">
          <when condition="(../mode = 'vxlan-mode')"/>
          <description>
            <text>List of provider edge nodes that a EVPL instance corresponds with VXLAN encapsulation.</text>
          </description>
          <list name="peer">
            <key value="name peer-ip"/>
            <max-elements value="1"/>
            <description>
              <text>Configure provider edge node that a EVPL instance corresponds with VXLAN encapsulation.</text>
            </description>
            <leaf name="name">
              <type name="leafref">
                <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
              </type>
              <must condition="/ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:type = 'PW-VE' and /ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:class = 'main-interface'"/>
              <description>
                <text>The name of interface.</text>
              </description>
            </leaf>
            <leaf name="peer-ip">
              <type name="inet:ipv4-address-no-zone"/>
              <description>
                <text>The address of provider edge node.</text>
              </description>
            </leaf>
          </list>
        </container>
        <container name="evpl-statistics">
          <when condition="(../mode = 'vxlan-mode')"/>
          <description>
            <text>Configure an EVPL instance.</text>
          </description>
          <leaf name="statistics-enable">
            <type name="boolean"/>
            <default value="false"/>
            <description>
              <text>Enable/disable EVPL message statistical function.</text>
            </description>
          </leaf>
        </container>
      </list>
    </container>
  </container>
</module>
