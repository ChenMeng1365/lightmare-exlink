<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-efm"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:efm="urn:huawei:yang:huawei-efm"
        xmlns:pub-type="urn:huawei:yang:huawei-pub-type"
        xmlns:yang="urn:ietf:params:xml:ns:yang:ietf-yang-types"
        xmlns:ext="urn:huawei:yang:huawei-extension"
        xmlns:ifm="urn:huawei:yang:huawei-ifm">
  <namespace uri="urn:huawei:yang:huawei-efm"/>
  <prefix value="efm"/>
  <import module="huawei-pub-type">
    <prefix value="pub-type"/>
  </import>
  <import module="ietf-yang-types">
    <prefix value="yang"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Ethernet in the First Mile, which is used for fault and performance detection.</text>
  </description>
  <revision date="2019-04-28">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <ext:task-name value="efm"/>
  <typedef name="enable-state">
    <type name="enumeration">
      <enum name="disable">
        <value value="0"/>
        <description>
          <text>Indicates that EFM is disabled.</text>
        </description>
      </enum>
      <enum name="enable">
        <value value="1"/>
        <description>
          <text>Indicates that EFM is enabled.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Enable-state.</text>
    </description>
  </typedef>
  <typedef name="work-mode">
    <type name="enumeration">
      <enum name="active">
        <value value="1"/>
        <description>
          <text>Indicates that EFM works in active mode.</text>
        </description>
      </enum>
      <enum name="passive">
        <value value="0"/>
        <description>
          <text>Indicates that EFM works in passive mode.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Work-mode.</text>
    </description>
  </typedef>
  <typedef name="session-state">
    <type name="enumeration">
      <enum name="discovery">
        <value value="2"/>
        <description>
          <text>Indicates that the EFM session is in the discovery state.</text>
        </description>
      </enum>
      <enum name="detect">
        <value value="1"/>
        <description>
          <text>Indicates that the EFM session is in the detect state.</text>
        </description>
      </enum>
      <enum name="loopback-be-controlled">
        <value value="5"/>
        <description>
          <text>Indicates that the EFM session is in the loopback state on the end that receives the session connection request.</text>
        </description>
      </enum>
      <enum name="loopback-control">
        <value value="3"/>
        <description>
          <text>Indicates that the EFM session is in the loopback state on the end that initiates the session connection request.</text>
        </description>
      </enum>
      <enum name="loopback-control-forward">
        <value value="4"/>
        <description>
          <text>The EFM session is in the Loopback state (control, forward).</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Session-state.</text>
    </description>
  </typedef>
  <typedef name="parser-action">
    <type name="enumeration">
      <enum name="forward">
        <value value="0"/>
        <description>
          <text>The EFM parser action is forward.</text>
        </description>
      </enum>
      <enum name="loopback">
        <value value="1"/>
        <description>
          <text>The EFM parser action is loopback.</text>
        </description>
      </enum>
      <enum name="discard">
        <value value="2"/>
        <description>
          <text>The EFM parser action is discard.</text>
        </description>
      </enum>
      <enum name="reserve">
        <value value="3"/>
        <description>
          <text>The EFM parser action is reserve.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Parser-action.</text>
    </description>
  </typedef>
  <typedef name="multiplexer-action">
    <type name="enumeration">
      <enum name="forward">
        <value value="0"/>
        <description>
          <text>The EFM multiplexer action is forward.</text>
        </description>
      </enum>
      <enum name="discard">
        <value value="1"/>
        <description>
          <text>The EFM multiplexer action is discard.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Multiplexer-action.</text>
    </description>
  </typedef>
  <typedef name="test-packet-status">
    <type name="enumeration">
      <enum name="working">
        <value value="0"/>
        <description>
          <text>The EFM test packet is working.</text>
        </description>
      </enum>
      <enum name="finished">
        <value value="1"/>
        <description>
          <text>The EFM test packet is finished.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The type of efm test packet status.</text>
    </description>
  </typedef>
  <typedef name="discovery-state">
    <type name="enumeration">
      <enum name="FAULT">
        <value value="0"/>
        <description>
          <text>FAULT state.</text>
        </description>
      </enum>
      <enum name="ACTIVE-SEND-LOCAL">
        <value value="1"/>
        <description>
          <text>ACTIVE_SEND_LOCAL state.</text>
        </description>
      </enum>
      <enum name="PASSIVE-WAIT">
        <value value="2"/>
        <description>
          <text>PASSIVE_WAIT state.</text>
        </description>
      </enum>
      <enum name="SEND-LOCAL-REMOTE">
        <value value="3"/>
        <description>
          <text>SEND_LOCAL_REMOTE state.</text>
        </description>
      </enum>
      <enum name="SEND-LOCAL-REMOTE-OK">
        <value value="4"/>
        <description>
          <text>SEND_LOCAL_REMOTE_OK state.</text>
        </description>
      </enum>
      <enum name="SEND-ANY">
        <value value="5"/>
        <description>
          <text>SEND_ANY state.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The type of efm discovery state.</text>
    </description>
  </typedef>
  <typedef name="error-frame-period-unit">
    <type name="enumeration">
      <enum name="second">
        <value value="0"/>
        <description>
          <text>Error frame period unit: seconds.</text>
        </description>
      </enum>
      <enum name="millisecond">
        <value value="1"/>
        <description>
          <text>Error frame period unit: milliseconds.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>EFM error frame period unit.</text>
    </description>
  </typedef>
  <typedef name="loopback-state">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>Indicates that the EFM session is in the Loopback state (none).</text>
        </description>
      </enum>
      <enum name="loopback-be-controlled">
        <value value="1"/>
        <description>
          <text>Indicates that the EFM session is in the Loopback state on the end that receives the session connection request.</text>
        </description>
      </enum>
      <enum name="loopback-control">
        <value value="2"/>
        <description>
          <text>Indicates that the EFM session is in the Loopback state on the end that initiates the session connection request.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The type of EFM loopback state.</text>
    </description>
  </typedef>
  <typedef name="extended-info-transmit-type">
    <type name="enumeration">
      <enum name="receive">
        <value value="0"/>
        <description>
          <text>EFM receives extended information.</text>
        </description>
      </enum>
      <enum name="send">
        <value value="1"/>
        <description>
          <text>EFM sends extended information.</text>
        </description>
      </enum>
      <enum name="send-and-receive">
        <value value="2"/>
        <description>
          <text>EFM sends and receives extended information.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The type of EFM extended information transmit.</text>
    </description>
  </typedef>
  <grouping name="link-event-statistics">
    <description>
      <text>Specify the link monitoring instance configured on the local EFM-enabled interface.</text>
    </description>
    <leaf name="errors">
      <type name="uint64"/>
      <config value="false"/>
      <description>
        <text>Specify the number of error codes counted on an EFM-enabled interface within the latest period.</text>
      </description>
    </leaf>
    <leaf name="total-errors">
      <type name="uint64"/>
      <config value="false"/>
      <description>
        <text>Specify the total number of error codes on an EFM-enabled interface.</text>
      </description>
    </leaf>
    <leaf name="total-events">
      <type name="uint32"/>
      <config value="false"/>
      <description>
        <text>Specify the total number of error code events on an EFM-enabled interface.</text>
      </description>
    </leaf>
  </grouping>
  <container name="efm">
    <presence value="Enables EFM"/>
    <description>
      <text>Ethernet in the First Mile, which is used for fault and performance detection.</text>
    </description>
    <container name="error-packets">
      <config value="false"/>
      <description>
        <text>List of EFM error packet.</text>
      </description>
      <list name="error-packet">
        <key value="slot-id pkt-number"/>
        <config value="false"/>
        <description>
          <text>Statistics of EFM error packet.</text>
        </description>
        <leaf name="slot-id">
          <type name="string">
            <length value="1..23"/>
          </type>
          <description>
            <text>Specify the slot ID.</text>
          </description>
        </leaf>
        <leaf name="pkt-number">
          <type name="uint32">
            <range value="1..10"/>
          </type>
          <description>
            <text>Packet number.</text>
          </description>
        </leaf>
        <leaf name="if-name">
          <type name="leafref">
            <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
          </type>
          <description>
            <text>Specify the name of the interface.</text>
          </description>
        </leaf>
        <leaf name="time">
          <type name="yang:date-and-time"/>
          <description>
            <text>Time.</text>
          </description>
        </leaf>
        <leaf name="packet">
          <type name="string">
            <length value="0..1024"/>
          </type>
          <description>
            <text>Content of the error packet.</text>
          </description>
        </leaf>
        <leaf name="reason">
          <type name="string">
            <length value="0..64"/>
          </type>
          <description>
            <text>Error packet reason.</text>
          </description>
        </leaf>
      </list>
    </container>
  </container>
  <rpc name="efm-loopback-start">
    <description>
      <text>Enable remote loopback.</text>
    </description>
    <ext:node-ref value="/ifm:ifm/ifm:interfaces/ifm:interface/efm:efm/efm:session"/>
    <input>
      <leaf name="if-name">
        <type name="leafref">
          <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Specify the interface enabled with remote loopback.</text>
        </description>
      </leaf>
      <leaf name="timeout">
        <type name="uint16">
          <range value="0..1000"/>
        </type>
        <default value="20"/>
        <description>
          <text>Specify the timeout period for remote loopback.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="efm-loopback-stop">
    <description>
      <text>Disable remote loopback.</text>
    </description>
    <ext:node-ref value="/ifm:ifm/ifm:interfaces/ifm:interface/efm:efm/efm:session"/>
    <input>
      <leaf name="if-name">
        <type name="leafref">
          <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Specify the interface enabled with remote loopback.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="efm-recover-efm-down">
    <description>
      <text>Indicate that the interface blocked by EFM goes up.</text>
    </description>
    <ext:node-ref value="/ifm:ifm/ifm:interfaces/ifm:interface/efm:efm/efm:session"/>
    <input>
      <leaf name="if-name">
        <type name="leafref">
          <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Specify the name of the interface enabled with EFM.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="efm-test-packet">
    <description>
      <text>Send test packets.</text>
    </description>
    <ext:node-ref value="/ifm:ifm/ifm:interfaces/ifm:interface/efm:efm/efm:session"/>
    <input>
      <leaf name="if-name">
        <type name="leafref">
          <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>Specify the name of the interface sending test packets.</text>
        </description>
      </leaf>
      <leaf name="packet-size">
        <type name="uint32">
          <range value="64..1518"/>
        </type>
        <units name="Byte"/>
        <default value="64"/>
        <description>
          <text>Specify the size of the sent test packet.</text>
        </description>
      </leaf>
      <leaf name="packet-count">
        <type name="uint32">
          <range value="1..65535"/>
        </type>
        <default value="5"/>
        <description>
          <text>Specify the number of sent test packets.</text>
        </description>
      </leaf>
      <leaf name="packet-speed">
        <type name="uint32">
          <range value="1..5"/>
        </type>
        <units name="Mbit/s"/>
        <default value="1"/>
        <description>
          <text>Specify the speed at which test packets are sent.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <augment target-node="/ifm:ifm/ifm:interfaces/ifm:interface">
    <when condition="/efm:efm"/>
    <description>
      <text>EFM configuration in interface.</text>
    </description>
    <container name="efm">
      <description>
        <text>Configure EFM on the interface.</text>
      </description>
      <container name="session">
        <description>
          <text>Configure EFM on the local interface.</text>
        </description>
        <leaf name="state">
          <type name="enable-state"/>
          <default value="disable"/>
          <description>
            <text>Indicates whether EFM is enabled on an interface.</text>
          </description>
        </leaf>
        <leaf name="mode">
          <type name="work-mode"/>
          <default value="active"/>
          <description>
            <text>Specify the working mode of an EFM-enabled interface.</text>
          </description>
        </leaf>
        <leaf name="packet-max-size">
          <type name="uint16">
            <range value="64..1518"/>
          </type>
          <units name="Byte"/>
          <default value="128"/>
          <description>
            <text>Specify the maximum size of an EFM packet.</text>
          </description>
        </leaf>
        <leaf name="interval">
          <type name="uint16">
            <range value="100..1000"/>
          </type>
          <units name="ms"/>
          <must condition="(../interval) mod 100 = 0"/>
          <default value="1000"/>
          <description>
            <text>Specify the interval at which EFM packets are sent.</text>
          </description>
        </leaf>
        <leaf name="timeout">
          <type name="uint16">
            <range value="300..30000"/>
          </type>
          <units name="ms"/>
          <must condition="(../timeout) mod 100 = 0"/>
          <default value="5000"/>
          <description>
            <text>Specify the timeout period for receiving EFM packets.</text>
          </description>
        </leaf>
        <leaf name="ignore-loopback-request">
          <type name="enable-state"/>
          <must condition="(../state='disable' and ../ignore-loopback-request='disable') or (../state='enable')"/>
          <default value="disable"/>
          <description>
            <text>Indicates that this interface will ignore the loopback request from the peer.</text>
          </description>
        </leaf>
        <leaf name="trigger-if-down">
          <type name="enable-state"/>
          <must condition="(../state='disable' and ../trigger-if-down='disable') or (../state='enable')"/>
          <default value="disable"/>
          <description>
            <text>Indicates that EFM blocks an interface after detecting a fault.</text>
          </description>
        </leaf>
        <leaf name="hold-up-time">
          <type name="uint16">
            <range value="0..50"/>
          </type>
          <units name="s"/>
          <default value="0"/>
          <description>
            <text>Specify the time waiting for an interface blocked by EFM to go up.</text>
          </description>
        </leaf>
        <leaf name="trigger-mac-renew">
          <type name="boolean"/>
          <must condition="(../state='disable' and ../trigger-mac-renew='false') or (../state='enable')"/>
          <default value="false"/>
          <description>
            <text>Enable/disable that EFM clears the MAC address of an interface after detecting a fault.</text>
          </description>
        </leaf>
        <leaf name="local-state">
          <type name="session-state"/>
          <config value="false"/>
          <description>
            <text>Status of the local EFM state machine.</text>
          </description>
        </leaf>
        <leaf name="loopback-timeout">
          <type name="uint16">
            <range value="0..1000"/>
          </type>
          <units name="min"/>
          <default value="20"/>
          <config value="false"/>
          <description>
            <text>Specify the timeout period for remote loopback.</text>
          </description>
        </leaf>
        <leaf name="parser-action">
          <type name="parser-action"/>
          <default value="forward"/>
          <config value="false"/>
          <description>
            <text>Local parser.</text>
          </description>
        </leaf>
        <leaf name="multiplexer-action">
          <type name="multiplexer-action"/>
          <default value="forward"/>
          <config value="false"/>
          <description>
            <text>Local multiplexer.</text>
          </description>
        </leaf>
        <container name="error-frame">
          <description>
            <text>Configure the error frame function.</text>
          </description>
          <leaf name="notification">
            <type name="enable-state"/>
            <default value="disable"/>
            <description>
              <text>Indicates whether notification of error frames is enabled.</text>
            </description>
          </leaf>
          <leaf name="period">
            <type name="uint32">
              <range value="1..60"/>
            </type>
            <units name="s"/>
            <default value="1"/>
            <description>
              <text>Specify the interval at which error frames are detected.</text>
            </description>
          </leaf>
          <leaf name="threshold">
            <type name="uint32">
              <range value="0..65535"/>
            </type>
            <default value="1"/>
            <description>
              <text>Specify the threshold for error frames.</text>
            </description>
          </leaf>
          <leaf name="period-unit">
            <type name="error-frame-period-unit"/>
            <default value="second"/>
            <config value="false"/>
            <description>
              <text>Period unit of an error frame event.</text>
            </description>
          </leaf>
          <uses name="link-event-statistics"/>
        </container>
        <container name="error-frame-second">
          <description>
            <text>Configure the error frames second function.</text>
          </description>
          <leaf name="notification">
            <type name="enable-state"/>
            <default value="disable"/>
            <description>
              <text>Indicates whether notification of error frame seconds is enabled.</text>
            </description>
          </leaf>
          <leaf name="period">
            <type name="uint32">
              <range value="10..900"/>
            </type>
            <units name="s"/>
            <default value="60"/>
            <description>
              <text>Specify the interval at which error frame seconds are detected.</text>
            </description>
          </leaf>
          <leaf name="threshold">
            <type name="uint32">
              <range value="0..900"/>
            </type>
            <units name="s"/>
            <must condition="(../threshold&lt;=../period)"/>
            <default value="1"/>
            <description>
              <text>Specify the threshold for error frame seconds.</text>
            </description>
          </leaf>
          <uses name="link-event-statistics"/>
        </container>
        <container name="error-code">
          <description>
            <text>Configure the error code function.</text>
          </description>
          <leaf name="notification">
            <type name="enable-state"/>
            <default value="disable"/>
            <description>
              <text>Indicates whether notification of error codes is enabled.</text>
            </description>
          </leaf>
          <leaf name="period">
            <type name="uint32">
              <range value="1..60"/>
            </type>
            <units name="s"/>
            <default value="1"/>
            <description>
              <text>Specify the interval at which error codes are detected.</text>
            </description>
          </leaf>
          <leaf name="threshold">
            <type name="uint32">
              <range value="0..65535"/>
            </type>
            <default value="1"/>
            <description>
              <text>Specify the threshold for error codes.</text>
            </description>
          </leaf>
          <uses name="link-event-statistics"/>
        </container>
        <container name="error-frame-period">
          <description>
            <text>Configure the error frame period function.</text>
          </description>
          <leaf name="notification">
            <type name="enable-state"/>
            <default value="disable"/>
            <description>
              <text>Indicates whether notification of error frame periods is enabled.</text>
            </description>
          </leaf>
          <leaf name="period">
            <type name="uint32">
              <range value="20000..4294967295"/>
            </type>
            <default value="200000"/>
            <description>
              <text>Specify the interval at which error frame periods are detected.</text>
            </description>
          </leaf>
          <leaf name="threshold">
            <type name="uint32">
              <range value="0..4294967295"/>
            </type>
            <must condition="(../threshold&lt;=../period)"/>
            <default value="1"/>
            <description>
              <text>Specify the threshold for error frame periods.</text>
            </description>
          </leaf>
          <uses name="link-event-statistics"/>
        </container>
      </container>
      <container name="remote-session">
        <config value="false"/>
        <description>
          <text>Operational data of EFM session on the remote interface.</text>
        </description>
        <leaf name="mac">
          <type name="pub-type:mac-address"/>
          <description>
            <text>Specify the MAC address of the remote device.</text>
          </description>
        </leaf>
        <leaf name="state">
          <type name="enable-state"/>
          <description>
            <text>Enable EFM on the interface of the remote device.</text>
          </description>
        </leaf>
        <leaf name="mode">
          <type name="work-mode"/>
          <description>
            <text>Specify the working mode of the EFM-enabled interface on the remote device.</text>
          </description>
        </leaf>
        <leaf name="packet-max-size">
          <type name="uint16"/>
          <description>
            <text>Specify the maximum size of an EFM packet.</text>
          </description>
        </leaf>
        <leaf name="ignore-loopback">
          <type name="enable-state"/>
          <description>
            <text>Indicates that the peer will ignore the loopback request.</text>
          </description>
        </leaf>
        <leaf name="parser-action">
          <type name="parser-action"/>
          <description>
            <text>Remote EFM parser.</text>
          </description>
        </leaf>
        <leaf name="multiplexer-action">
          <type name="multiplexer-action"/>
          <description>
            <text>Remote EFM multiplexer.</text>
          </description>
        </leaf>
      </container>
      <container name="test-result">
        <config value="false"/>
        <description>
          <text>Test packet statistics.</text>
        </description>
        <leaf name="send-packet-number">
          <type name="uint32"/>
          <description>
            <text>Specify the number of sent test packets.</text>
          </description>
        </leaf>
        <leaf name="receive-packet-number">
          <type name="uint32"/>
          <description>
            <text>Specify the number of received test packets.</text>
          </description>
        </leaf>
        <leaf name="drop-packet-number">
          <type name="uint32"/>
          <description>
            <text>Specify the number of dropped test packets.</text>
          </description>
        </leaf>
        <leaf name="send-packet-total">
          <type name="uint32"/>
          <description>
            <text>Specify the total number of bytes of sent test packets.</text>
          </description>
        </leaf>
        <leaf name="receive-packet-total">
          <type name="uint32"/>
          <description>
            <text>Specify the total number of bytes of received test packets.</text>
          </description>
        </leaf>
        <leaf name="drop-packet-total">
          <type name="uint32"/>
          <description>
            <text>Specify the total number of bytes of dropped test packets.</text>
          </description>
        </leaf>
        <leaf name="start-time">
          <type name="yang:date-and-time"/>
          <description>
            <text>Specify the time to start sending test packets.</text>
          </description>
        </leaf>
        <leaf name="stop-time">
          <type name="yang:date-and-time"/>
          <description>
            <text>Specify the time to stop sending test packets.</text>
          </description>
        </leaf>
        <leaf name="status">
          <type name="test-packet-status"/>
          <default value="finished"/>
          <description>
            <text>Specify the status of test packets.</text>
          </description>
        </leaf>
      </container>
    </container>
  </augment>
</module>
