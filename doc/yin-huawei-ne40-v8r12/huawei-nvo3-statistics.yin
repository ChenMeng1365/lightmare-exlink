<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-nvo3-statistics"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:nvo3-statistics="urn:huawei:yang:huawei-nvo3-statistics"
        xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
        xmlns:nvo3="urn:huawei:yang:huawei-nvo3"
        xmlns:ifm="urn:huawei:yang:huawei-ifm"
        xmlns:ext="urn:huawei:yang:huawei-extension">
  <namespace uri="urn:huawei:yang:huawei-nvo3-statistics"/>
  <prefix value="nvo3-statistics"/>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="huawei-nvo3">
    <prefix value="nvo3"/>
  </import>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Management for data center network virtualization over Layer 3.</text>
  </description>
  <revision date="2020-03-30">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <typedef name="vxlan-mode">
    <type name="enumeration">
      <enum name="l2">
        <value value="0"/>
        <description>
          <text>Layer 2.</text>
        </description>
      </enum>
      <enum name="l3">
        <value value="1"/>
        <description>
          <text>Layer 3.</text>
        </description>
      </enum>
      <enum name="both">
        <value value="2"/>
        <description>
          <text>Both layer 2 and 3.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>VXLAN mode.</text>
    </description>
  </typedef>
  <typedef name="statistics-direction">
    <type name="enumeration">
      <enum name="inbound">
        <value value="0"/>
        <description>
          <text>Inbound direction.</text>
        </description>
      </enum>
      <enum name="outbound">
        <value value="1"/>
        <description>
          <text>Outbound direction.</text>
        </description>
      </enum>
      <enum name="bidirection">
        <value value="2"/>
        <description>
          <text>Bidirection.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>VXLAN tunnel traffic statistics type.</text>
    </description>
  </typedef>
  <grouping name="vxlan-traffic-collection">
    <description>
      <text>VXLAN tunnel traffic statistics collection.</text>
    </description>
    <leaf name="send-bits-rate">
      <type name="uint64"/>
      <units name="bit/s"/>
      <description>
        <text>Number of send bits per second.</text>
      </description>
    </leaf>
    <leaf name="send-pkts-rate">
      <type name="uint64"/>
      <units name="pps"/>
      <description>
        <text>Number of send packets per second.</text>
      </description>
    </leaf>
    <leaf name="send-unicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of send unicast packets.</text>
      </description>
    </leaf>
    <leaf name="send-multicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of send multicast packets.</text>
      </description>
    </leaf>
    <leaf name="send-broadcast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of send broadcast packets.</text>
      </description>
    </leaf>
    <leaf name="send-total-bytes">
      <type name="uint64"/>
      <units name="Byte"/>
      <description>
        <text>Total number of send bytes.</text>
      </description>
    </leaf>
    <leaf name="send-total-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Total number of send packets.</text>
      </description>
    </leaf>
    <leaf name="receive-bits-rate">
      <type name="uint64"/>
      <units name="bit/s"/>
      <description>
        <text>Number of receive bits per second.</text>
      </description>
    </leaf>
    <leaf name="receive-pkts-rate">
      <type name="uint64"/>
      <units name="pps"/>
      <description>
        <text>Number of receive packets per second.</text>
      </description>
    </leaf>
    <leaf name="receive-unicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of receive unicast packets.</text>
      </description>
    </leaf>
    <leaf name="receive-multicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of receive multicast packets.</text>
      </description>
    </leaf>
    <leaf name="receive-broadcast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of receive broadcast packets.</text>
      </description>
    </leaf>
    <leaf name="receive-total-bytes">
      <type name="uint64"/>
      <units name="Byte"/>
      <description>
        <text>Total number of receive bytes.</text>
      </description>
    </leaf>
    <leaf name="receive-total-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Total number of receive packets.</text>
      </description>
    </leaf>
    <leaf name="drop-unicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of discarded unicast packets.</text>
      </description>
    </leaf>
    <leaf name="drop-multicast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of discarded multicast packets.</text>
      </description>
    </leaf>
    <leaf name="drop-broadcast-pkts">
      <type name="uint64"/>
      <units name="packet"/>
      <description>
        <text>Number of discarded broadcast packets.</text>
      </description>
    </leaf>
  </grouping>
  <ext:task-name value="nvo3"/>
  <rpc name="reset-vni-label-statistics">
    <description>
      <text>Clear VXLAN tunnel traffic statistics collection for a VNI.</text>
    </description>
    <ext:node-ref value="/nvo3:nvo3/nvo3:vni-labels/nvo3:vni-label/nvo3-statistics:statistics/nvo3-statistics:collections"/>
    <input>
      <leaf name="vni">
        <type name="uint32">
          <range value="1..16777215"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>VXLAN network identifier.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <rpc name="reset-vtep-statistics">
    <description>
      <text>Clear VXLAN tunnel traffic statistics collection for a VTEP.</text>
    </description>
    <ext:node-ref value="/ifm:ifm/ifm:interfaces/ifm:interface/nvo3-statistics:nvo3-vtep-statistics/nvo3-statistics:nvo3-vtep-statistic/nvo3-statistics:collections/nvo3-statistics:collection"/>
    <input>
      <leaf name="vni">
        <type name="uint32">
          <range value="1..16777215"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>VXLAN network identifier.</text>
        </description>
      </leaf>
      <leaf name="source">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The srource address of VTEP.</text>
        </description>
      </leaf>
      <leaf name="peer">
        <type name="inet:ipv4-address-no-zone"/>
        <mandatory value="true"/>
        <description>
          <text>The address of VTEP.</text>
        </description>
      </leaf>
      <leaf name="mode">
        <type name="vxlan-mode"/>
        <mandatory value="true"/>
        <description>
          <text>The type of VXLAN tunnel traffic statistics.</text>
        </description>
      </leaf>
      <leaf name="direction">
        <type name="statistics-direction"/>
        <must condition="(../mode = 'l2') or (../mode = 'l3' and (../direction != 'bidirection'))"/>
        <mandatory value="true"/>
        <description>
          <text>Traffic statistics direction.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <augment target-node="/ifm:ifm/ifm:interfaces/ifm:interface">
    <description>
      <text>The NVO3 statistics for interface.</text>
    </description>
    <container name="nvo3-vtep-statistics">
      <when condition="../ifm:type='Nve'"/>
      <description>
        <text>List of VXLAN tunnel statistics.</text>
      </description>
      <list name="nvo3-vtep-statistic">
        <key value="vni peer mode direction"/>
        <description>
          <text>Configure VTEP statistics collection.</text>
        </description>
        <leaf name="vni">
          <type name="uint32">
            <range value="0..16777215"/>
          </type>
          <must condition="(../vni = 0 and ../mode = 'l3' and ../direction = 'outbound' and not(../../nvo3-statistics:nvo3-vtep-statistic[nvo3-statistics:vni != 0][nvo3-statistics:peer = current()/../peer][nvo3-statistics:mode = current()/../mode][nvo3-statistics:direction = current()/../direction])) or (../vni != 0)"/>
          <description>
            <text>VXLAN network identifier.</text>
          </description>
        </leaf>
        <leaf name="peer">
          <type name="inet:ipv4-address-no-zone"/>
          <description>
            <text>The peer address of VTEP.</text>
          </description>
        </leaf>
        <leaf name="mode">
          <type name="vxlan-mode"/>
          <must condition="(../mode = 'l2' and not((../../nvo3-statistics:nvo3-vtep-statistic[nvo3-statistics:vni = current()/../vni][nvo3-statistics:peer = current()/../peer][nvo3-statistics:direction = 'inbound'] or ../../nvo3-statistics:nvo3-vtep-statistic[nvo3-statistics:vni = current()/../vni][nvo3-statistics:peer = current()/../peer][nvo3-statistics:direction = 'outbound']) and ../../nvo3-statistics:nvo3-vtep-statistic[nvo3-statistics:vni = current()/../vni][nvo3-statistics:peer = current()/../peer][nvo3-statistics:direction = 'bidirection'])) or (../mode != 'l2')"/>
          <description>
            <text>The type of VXLAN tunnel traffic statistics.</text>
          </description>
        </leaf>
        <leaf name="direction">
          <type name="statistics-direction"/>
          <must condition="(../mode = 'l2') or (../mode = 'l3' and (../direction != 'bidirection'))"/>
          <description>
            <text>Traffic statistics direction.</text>
          </description>
        </leaf>
        <container name="collections">
          <config value="false"/>
          <description>
            <text>List of Traffic statistics collection.</text>
          </description>
          <list name="collection">
            <key value="source-addr"/>
            <description>
              <text>Statistics of VXLAN tunnel traffic collection.</text>
            </description>
            <leaf name="source-addr">
              <type name="inet:ipv4-address-no-zone"/>
              <description>
                <text>The address of VTEP.</text>
              </description>
            </leaf>
            <uses name="vxlan-traffic-collection"/>
          </list>
        </container>
      </list>
    </container>
  </augment>
  <augment target-node="/nvo3:nvo3/nvo3:vni-labels/nvo3:vni-label">
    <description>
      <text>The NVO3 traffic statistics of vni.</text>
    </description>
    <container name="statistics">
      <description>
        <text>Configure VNI traffic statistics.</text>
      </description>
      <leaf name="enable">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable VNI traffic statistics.</text>
        </description>
      </leaf>
      <container name="collections">
        <when condition="../enable='true'"/>
        <config value="false"/>
        <description>
          <text>Statistics of VNI traffic statistics collection.</text>
        </description>
        <uses name="vxlan-traffic-collection"/>
      </container>
    </container>
  </augment>
</module>
