<?xml version="1.0" encoding="UTF-8"?>
<submodule name="huawei-aaa-lam"
           xmlns="urn:ietf:params:xml:ns:yang:yin:1"
           xmlns:aaa="urn:huawei:yang:huawei-aaa"
           xmlns:pub-type="urn:huawei:yang:huawei-pub-type"
           xmlns:yang="urn:ietf:params:xml:ns:yang:ietf-yang-types"
           xmlns:ext="urn:huawei:yang:huawei-extension">
  <belongs-to module="huawei-aaa">
    <prefix value="aaa"/>
  </belongs-to>
  <import module="huawei-pub-type">
    <prefix value="pub-type"/>
  </import>
  <import module="ietf-yang-types">
    <prefix value="yang"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <include module="huawei-aaa-type"/>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Description of local access manage submodule.</text>
  </description>
  <revision date="2021-02-05">
    <description>
      <text>Add node enable of login-failed-limit.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2020-03-02">
    <description>
      <text>Init revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <grouping name="aaa-lam-type">
    <description>
      <text>Local management.</text>
    </description>
    <container name="login-failed-limit">
      <description>
        <text>Configure login failed times limit in special period.</text>
      </description>
      <leaf name="failed-times">
        <type name="uint32">
          <range value="0..10"/>
        </type>
        <default value="5"/>
        <description>
          <text>Indicates the consecutive failure times. 0 indicates that the number of times for a user to fail the authentification continuously is not restricted.</text>
        </description>
      </leaf>
      <leaf name="period">
        <type name="uint32">
          <range value="1..120"/>
        </type>
        <units name="min"/>
        <default value="5"/>
        <description>
          <text>Specifies a period for consecutive authentication failures.</text>
        </description>
      </leaf>
      <leaf name="reactive-time">
        <type name="uint32">
          <range value="0..1000"/>
        </type>
        <units name="min"/>
        <default value="5"/>
        <description>
          <text>Specifies an automatic activation time for a locked account. 0 indicates that the locked account will not be unlocked automatically.</text>
        </description>
      </leaf>
    </container>
    <container name="user-security-policy">
      <description>
        <text>Configure local user security policy.</text>
      </description>
      <leaf name="security-policy">
        <type name="boolean"/>
        <default value="true"/>
        <description>
          <text>Enable/disable the local user security policy function.</text>
        </description>
      </leaf>
      <leaf name="user-aging-period">
        <type name="uint32">
          <range value="1..365"/>
        </type>
        <description>
          <text>The period of user age.</text>
        </description>
      </leaf>
      <leaf name="user-name-min-len">
        <type name="uint32">
          <range value="0..253"/>
        </type>
        <default value="0"/>
        <description>
          <text>The minimum length of username, 0 indicates that the length is not limited.</text>
        </description>
      </leaf>
    </container>
    <container name="password-policy">
      <description>
        <text>Configure local-user password policy.</text>
      </description>
      <leaf name="expire-days">
        <type name="uint16">
          <range value="0..365"/>
        </type>
        <units name="d"/>
        <must condition="../prompt-days&lt;=../expire-days"/>
        <default value="0"/>
        <description>
          <text>Password expire days, 0 indicates that password is useful forever.</text>
        </description>
      </leaf>
      <leaf name="prompt-days">
        <type name="uint16">
          <range value="0..180"/>
        </type>
        <units name="d"/>
        <must condition="../prompt-days&lt;=../expire-days"/>
        <default value="0"/>
        <description>
          <text>Password promptdays.</text>
        </description>
      </leaf>
      <leaf name="change-check">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable the function to prompt a user to change the password upon first-time use.</text>
        </description>
      </leaf>
      <leaf name="complexity-check">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable password complexity check.</text>
        </description>
      </leaf>
      <leaf name="pwd-min-length">
        <type name="uint32">
          <range value="3..128"/>
        </type>
        <description>
          <text>Specifies a minimum password length for local users.</text>
        </description>
      </leaf>
      <leaf name="expired-pwd-reuse-num">
        <type name="uint32"/>
        <config value="false"/>
        <description>
          <text>Max. Number of times to reuse expired password.</text>
        </description>
      </leaf>
      <leaf name="history-pwd-num">
        <type name="uint32">
          <range value="1..20"/>
        </type>
        <default value="10"/>
        <description>
          <text>History password number.</text>
        </description>
      </leaf>
      <leaf name="pwd-expire-days">
        <type name="uint32"/>
        <units name="d"/>
        <config value="false"/>
        <description>
          <text>The passowrd will expire in the special days.</text>
        </description>
      </leaf>
      <leaf name="pwd-force-change">
        <type name="boolean"/>
        <default value="true"/>
        <description>
          <text>Enable/disable the function of forcing a user to change the password upon first use.</text>
        </description>
      </leaf>
    </container>
    <container name="forbidden-word-rules">
      <description>
        <text>List of password black.</text>
      </description>
      <list name="forbidden-word-rule">
        <key value="forbidden-word"/>
        <description>
          <text>Configure password forbidden rule.</text>
        </description>
        <leaf name="forbidden-word">
          <type name="string">
            <length value="1..255"/>
          </type>
          <ext:case-sensitivity value="lower-or-upper"/>
          <description>
            <text>Forbidden word.</text>
          </description>
        </leaf>
      </list>
    </container>
    <container name="users">
      <description>
        <text>List of local user.</text>
      </description>
      <list name="user">
        <key value="name"/>
        <max-elements value="1024"/>
        <description>
          <text>Configure local user.</text>
        </description>
        <leaf name="name">
          <type name="string">
            <length value="1..253"/>
            <pattern value="[^A-Z]+"/>
          </type>
          <description>
            <text>Name of a local user. The minimum length of a username is determined by user-name-min-len and security-policy. If security-policy is set to false and user-name-min-len is configured, the configuration takes effect. When security-policy is set to true, the minimum length of the username must be at least 6 characters. If user-name-min-len is configured and the user-name-min-len value is greater than 6 characters, the minimum length of the username is equal to the user-name-min-len value. If security-policy is set to false and user-name-min-len is not configured, the minimum length of the username is 1. If the username contains more than 32 characters, service-snmp cannot be set to true.</text>
          </description>
        </leaf>
        <leaf name="end-life-date">
          <type name="pub-type:date"/>
          <description>
            <text>The end date of local user's life.</text>
          </description>
        </leaf>
        <leaf name="is-login-anytime">
          <type name="boolean"/>
          <must condition="(not(../begin-login-day='sun' and ../end-login-day='sat' and ../begin-login-time='00:00:00' and ../end-login-time='23:59:59') and ../is-login-anytime='false') or (../begin-login-day='sun' and ../end-login-day='sat' and ../begin-login-time='00:00:00' and ../end-login-time='23:59:59' and ../is-login-anytime='true')"/>
          <default value="true"/>
          <description>
            <text>Enable/disable the flag of login anytime.</text>
          </description>
        </leaf>
        <leaf name="begin-login-day">
          <type name="lam-weekday-type"/>
          <must condition="not(../is-login-anytime='true') or (../is-login-anytime='true' and ../begin-login-day='sun')"/>
          <default value="sun"/>
          <description>
            <text>The begin day of week for login.</text>
          </description>
        </leaf>
        <leaf name="end-login-day">
          <type name="lam-weekday-type"/>
          <must condition="not(../is-login-anytime='true') or (../is-login-anytime='true' and ../end-login-day='sat')"/>
          <default value="sat"/>
          <description>
            <text>The end day of week for login.</text>
          </description>
        </leaf>
        <leaf name="begin-login-time">
          <type name="pub-type:time"/>
          <must condition="not(../is-login-anytime='true') or (../is-login-anytime='true' and ../begin-login-time='00:00:00')"/>
          <default value="00:00:00"/>
          <description>
            <text>The begin time of every login day. The begin-login-time must be five or more minutes earlier than the end-login-time.</text>
          </description>
        </leaf>
        <leaf name="end-login-time">
          <type name="pub-type:time"/>
          <must condition="not(../is-login-anytime='true') or (../is-login-anytime='true' and ../end-login-time='23:59:59')"/>
          <default value="23:59:59"/>
          <description>
            <text>The end time of every login day. The end-login-time must be five or more minutes later than the begin-login-time.</text>
          </description>
        </leaf>
        <leaf name="aging-in-days">
          <type name="uint32">
            <range value="0..365"/>
          </type>
          <units name="d"/>
          <description>
            <text>The user will age if not online in the special days.</text>
          </description>
        </leaf>
        <leaf name="password-expire-in-days">
          <type name="uint32">
            <range value="0..999"/>
          </type>
          <units name="d"/>
          <description>
            <text>The passowrd will expire in the special days.</text>
          </description>
        </leaf>
        <leaf name="group-name">
          <type name="string">
            <length value="1..32"/>
          </type>
          <description>
            <text>Name of the user group where the user belongs, it must be an existing user group. The user inherits all the rights of the user group.</text>
          </description>
        </leaf>
        <leaf name="state">
          <type name="user-state-type"/>
          <default value="active"/>
          <description>
            <text>Activated state of a user.</text>
          </description>
        </leaf>
        <leaf name="failed-times">
          <when condition="../state='active'"/>
          <type name="uint32">
            <range value="0..10"/>
          </type>
          <must condition="(../interval) and ((../interval!=0) or (../failed-times=0 and ../interval=0))"/>
          <default value="0"/>
          <description>
            <text>When user continuous authen failed times reach the limit, the user is locked.</text>
          </description>
        </leaf>
        <leaf name="interval">
          <when condition="../state='active'"/>
          <type name="uint32">
            <range value="0..65535"/>
          </type>
          <units name="min"/>
          <must condition="(../failed-times) and ((../failed-times!=0) or (../failed-times=0 and ../interval=0))"/>
          <default value="0"/>
          <description>
            <text>Set a user lockout period (in minutes). If a user is locked due to consecutive authentication failures, the user is automatically unlocked after the set period expires. 0 indicats that the locked user is not automatically unlocked.</text>
          </description>
        </leaf>
        <leaf name="password-type">
          <type name="aaa-pwd-mode-type"/>
          <must condition="../password"/>
          <default value="irreversible-cipher"/>
          <description>
            <text>Set a password type, which can be cipher or irreversible-cipher. Cipher passwords are encrypted and generated using the reversible algorithm, while irreversible-cipher passwords are encrypted and generated using the irreversible algorithm.</text>
          </description>
        </leaf>
        <leaf name="password">
          <type name="pub-type:password-extend">
            <length value="1..268"/>
          </type>
          <mandatory value="true"/>
          <description>
            <text>Login password of a user, which is a string ranging from 1 to 128 characters for a unencrypted password and 32 to 268 characters for a encrypted password. The password can contain letters, numbers, and special characters. Chinese characters are not supported. The minimum length and complexity of a user password are restricted by pwd-min-length, security-policy, complexity-check, and forbidden-word. When security-policy is set to true, the minimum length of a password is 8 characters. In addition, complexity verification is enabled. The complexity requirements are as follows: (1) A password must contain digits, uppercase letters, lowercase letters, and special characters. Spaces and question marks are not supported. If the password is enclosed in quotation marks, spaces are allowed in the password. (2) The password cannot contain an account or the reverse string of an account. (3) The new password cannot be the same as any of the previous 10 passwords. (If the new password is the same as the current password, the new password is also considered as a history password. That is, the current password is included in the 10 history passwords.) This parameter takes effect when the password complexity check is enabled (complexity-check is set to true). If forbidden-word is configured, the password cannot contain forbidden words. If only the pwd-min-length value is set, the pwd-min-length setting takes effect. If the minimum length of a user password is set and the user security policy is enabled, the minimum length of a password cannot be less than 8 characters. If the minimum length of a password is set and the pwd-min-length value is greater than 8 characters, the minimum length of a password is determined by the pwd-min-length value.</text>
          </description>
        </leaf>
        <leaf name="level">
          <type name="uint32">
            <range value="0..15"/>
          </type>
          <description>
            <text>Login level of a local user. If the command level adjustment function is disabled, the value of userLevel ranges from 0 to 3. If the command level adjustment function is enabled, the value of userLevel ranges from 0 to 15.</text>
          </description>
        </leaf>
        <leaf name="ftp-dir">
          <type name="string">
            <length value="1..255"/>
          </type>
          <description>
            <text>FTP user directory.</text>
          </description>
        </leaf>
        <leaf name="service-terminal">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through a terminal.</text>
          </description>
        </leaf>
        <leaf name="service-telnet">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through Telnet.</text>
          </description>
        </leaf>
        <leaf name="service-ftp">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through FTP.</text>
          </description>
        </leaf>
        <leaf name="service-ppp">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through PPP.</text>
          </description>
        </leaf>
        <leaf name="service-ssh">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through SSH.</text>
          </description>
        </leaf>
        <leaf name="service-qx">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through QX.</text>
          </description>
        </leaf>
        <leaf name="service-snmp">
          <type name="boolean"/>
          <must condition="(../service-snmp='false') or (../service-snmp='true' and string-length(current()/../name)&lt;32)"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through SNMP.</text>
          </description>
        </leaf>
        <leaf name="service-mml">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through MML.</text>
          </description>
        </leaf>
        <leaf name="service-http">
          <type name="boolean"/>
          <default value="false"/>
          <description>
            <text>Enable/disable login through HTTP.</text>
          </description>
        </leaf>
        <leaf name="max-access-num">
          <type name="int32">
            <range value="1..2147483647"/>
          </type>
          <description>
            <text>The local user max access number.</text>
          </description>
        </leaf>
        <leaf name="idle-cut-enable">
          <type name="boolean"/>
          <default value="true"/>
          <description>
            <text>Enable/disable configures the idle cut function for a local user.</text>
          </description>
        </leaf>
        <leaf name="begin-life-date">
          <type name="pub-type:date"/>
          <config value="false"/>
          <description>
            <text>The begin date of local user's life.</text>
          </description>
        </leaf>
        <leaf name="last-login-time">
          <type name="yang:date-and-time"/>
          <config value="false"/>
          <description>
            <text>The last login time.</text>
          </description>
        </leaf>
        <leaf name="is-aged">
          <type name="aaa-bool-type"/>
          <config value="false"/>
          <description>
            <text>Whether the user is aged now.</text>
          </description>
        </leaf>
        <leaf name="is-locked">
          <type name="aaa-bool-type"/>
          <config value="false"/>
          <description>
            <text>Whether the user is locked now.</text>
          </description>
        </leaf>
        <leaf name="left-lock-time">
          <type name="uint32">
            <range value="1..4294967295"/>
          </type>
          <units name="s"/>
          <config value="false"/>
          <description>
            <text>Left lock time of locked user.</text>
          </description>
        </leaf>
        <leaf name="is-terminal-locked">
          <type name="aaa-bool-type"/>
          <config value="false"/>
          <description>
            <text>Whether the user is terminal locked now.</text>
          </description>
        </leaf>
        <leaf name="terminal-left-lock-time">
          <type name="uint32">
            <range value="1..4294967295"/>
          </type>
          <units name="s"/>
          <config value="false"/>
          <description>
            <text>Left lock time of terminal locked user.</text>
          </description>
        </leaf>
        <leaf name="pass-modify-time">
          <type name="yang:date-and-time"/>
          <config value="false"/>
          <description>
            <text>Password modify time.</text>
          </description>
        </leaf>
        <leaf name="is-pass-expired">
          <type name="is-pass-expired-type"/>
          <config value="false"/>
          <description>
            <text>Whether the password of this user name expires.</text>
          </description>
        </leaf>
        <leaf name="is-pass-changed">
          <type name="boolean"/>
          <config value="false"/>
          <description>
            <text>Whether the password of this user name is changed by the user.</text>
          </description>
        </leaf>
        <leaf name="alive-num">
          <type name="int32">
            <range value="0..2147483647"/>
          </type>
          <config value="false"/>
          <description>
            <text>Online number of the local user.</text>
          </description>
        </leaf>
      </list>
    </container>
  </grouping>
  <grouping name="aaa-local-server-type">
    <description>
      <text>Local aaa server.</text>
    </description>
    <container name="login-failed-limit">
      <description>
        <text>Configure the maximum number of login attempts allowed in the specified period.</text>
      </description>
      <leaf name="failed-times">
        <type name="uint32">
          <range value="0..10"/>
        </type>
        <default value="5"/>
        <description>
          <text>Indicates the consecutive failure times. 0 indicates that the number of times that a user fails authentication continuously is not restricted.</text>
        </description>
      </leaf>
      <leaf name="period">
        <type name="uint32">
          <range value="1..120"/>
        </type>
        <units name="min"/>
        <default value="5"/>
        <description>
          <text>Specifies a period for consecutive authentication failures.</text>
        </description>
      </leaf>
      <leaf name="reactive-time">
        <type name="uint32">
          <range value="0..1000"/>
        </type>
        <units name="min"/>
        <default value="5"/>
        <description>
          <text>Specifies an automatic activation time for a locked account. 0 indicates that the locked account will not be unlocked automatically.</text>
        </description>
      </leaf>
    </container>
    <container name="user-security-policy">
      <description>
        <text>Configure a local user security policy.</text>
      </description>
      <leaf name="user-aging-period">
        <type name="uint32">
          <range value="1..365"/>
        </type>
        <description>
          <text>Specifies an aging period for an administrator.</text>
        </description>
      </leaf>
      <leaf name="user-name-min-len">
        <type name="uint32">
          <range value="0..253"/>
        </type>
        <default value="0"/>
        <description>
          <text>Specifies the minimum length for user names. 0 indicates that the length is not limited.</text>
        </description>
      </leaf>
    </container>
    <container name="password-policy">
      <description>
        <text>Configure a local user password policy.</text>
      </description>
      <leaf name="expire-days">
        <type name="uint16">
          <range value="0..365"/>
        </type>
        <units name="d"/>
        <must condition="../prompt-days&lt;=../expire-days"/>
        <default value="0"/>
        <description>
          <text>Specifies an expiration period for a password. 0 indicates that a password is permanently valid.</text>
        </description>
      </leaf>
      <leaf name="prompt-days">
        <type name="uint16">
          <range value="0..180"/>
        </type>
        <units name="d"/>
        <must condition="../prompt-days&lt;=../expire-days"/>
        <default value="0"/>
        <description>
          <text>Specifies a remaining validity period for a password.</text>
        </description>
      </leaf>
      <leaf name="change-check">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable mandatory password change when a password is used for the first time.</text>
        </description>
      </leaf>
      <leaf name="complexity-check">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable password complexity enhancement.</text>
        </description>
      </leaf>
      <leaf name="pwd-min-length">
        <type name="uint32">
          <range value="3..128"/>
        </type>
        <description>
          <text>Specifies the minimum length for passwords configured for local users.</text>
        </description>
      </leaf>
    </container>
  </grouping>
  <rpc name="change-current-password">
    <description>
      <text>Modify password of current access-user.</text>
    </description>
    <input>
      <leaf name="old-password">
        <type name="pub-type:one-input-password-extend">
          <length value="1..128"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>The old password of the local user.</text>
        </description>
      </leaf>
      <leaf name="new-password">
        <type name="pub-type:password-extend">
          <length value="1..128"/>
        </type>
        <mandatory value="true"/>
        <description>
          <text>New password to set.</text>
        </description>
      </leaf>
    </input>
  </rpc>
</submodule>
