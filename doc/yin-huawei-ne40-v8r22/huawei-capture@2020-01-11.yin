<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-capture"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:capture="urn:huawei:yang:huawei-capture"
        xmlns:ext="urn:huawei:yang:huawei-extension"
        xmlns:ifm="urn:huawei:yang:huawei-ifm"
        xmlns:vlan="urn:huawei:yang:huawei-vlan"
        xmlns:acl="urn:huawei:yang:huawei-acl"
        xmlns:yang="urn:ietf:params:xml:ns:yang:ietf-yang-types">
  <yang-version value="1"/>
  <namespace uri="urn:huawei:yang:huawei-capture"/>
  <prefix value="capture"/>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <import module="huawei-vlan">
    <prefix value="vlan"/>
  </import>
  <import module="huawei-acl">
    <prefix value="acl"/>
  </import>
  <import module="ietf-yang-types">
    <prefix value="yang"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>Network capture.</text>
  </description>
  <revision date="2020-01-11">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <ext:task-name value="capture"/>
  <typedef name="tag-format">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>VXLAN overlay packets without VLAN tag.</text>
        </description>
      </enum>
      <enum name="single">
        <value value="1"/>
        <description>
          <text>VXLAN overlay packets with single VLAN tag.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Tag format of VXLAN overlay packets.</text>
    </description>
  </typedef>
  <typedef name="result">
    <type name="enumeration">
      <enum name="success">
        <value value="0"/>
        <description>
          <text>The packet obtain result is successful.</text>
        </description>
      </enum>
      <enum name="fail">
        <value value="1"/>
        <description>
          <text>The packet obtain result is fail.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Packet obtain result.</text>
    </description>
  </typedef>
  <typedef name="capture-index">
    <type name="uint32">
      <range value="1..8"/>
    </type>
    <description>
      <text>Index of the packet obtain instance.</text>
    </description>
  </typedef>
  <typedef name="direction">
    <type name="enumeration">
      <enum name="inbound">
        <value value="1"/>
        <description>
          <text>Inbound.</text>
        </description>
      </enum>
      <enum name="outbound">
        <value value="2"/>
        <description>
          <text>Outbound.</text>
        </description>
      </enum>
      <enum name="both">
        <value value="3"/>
        <description>
          <text>Both.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Packet obtain direction.</text>
    </description>
  </typedef>
  <typedef name="packet-header-status">
    <type name="enumeration">
      <enum name="stopped">
        <value value="0"/>
        <description>
          <text>Stop.</text>
        </description>
      </enum>
      <enum name="running">
        <value value="1"/>
        <description>
          <text>Running.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Packet obtain status.</text>
    </description>
  </typedef>
  <typedef name="packet-header-link-type">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>Interface of linktype.</text>
        </description>
      </enum>
      <enum name="ethernet">
        <value value="1"/>
        <description>
          <text>Ethernet of link type.</text>
        </description>
      </enum>
      <enum name="ppp">
        <value value="2"/>
        <description>
          <text>PPP protocol of link type.</text>
        </description>
      </enum>
      <enum name="hdlc">
        <value value="3"/>
        <description>
          <text>HDLC protocol of link type.</text>
        </description>
      </enum>
      <enum name="atm">
        <value value="4"/>
        <description>
          <text>ATM of link type.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Packet header link type.</text>
    </description>
  </typedef>
  <container name="capture">
    <description>
      <text>Forwarding packet headers information.</text>
    </description>
    <container name="capture-instances">
      <config value="false"/>
      <description>
        <text>List of obtain packet headers instance.</text>
      </description>
      <list name="capture-instance">
        <key value="instance-id"/>
        <description>
          <text>Operational data of obtain packet headers instance.</text>
        </description>
        <leaf name="instance-id">
          <type name="uint8">
            <range value="1..8"/>
          </type>
          <description>
            <text>Instance ID.</text>
          </description>
        </leaf>
        <leaf name="inbound-instance">
          <type name="uint32"/>
          <description>
            <text>Inbound instance.</text>
          </description>
        </leaf>
        <leaf name="outbound-instance">
          <type name="uint32"/>
          <description>
            <text>Outbound instance.</text>
          </description>
        </leaf>
        <leaf name="total-instance">
          <type name="uint32"/>
          <description>
            <text>Total instance statistic.</text>
          </description>
        </leaf>
        <leaf name="status">
          <type name="packet-header-status"/>
          <description>
            <text>Obtain packet headers status.</text>
          </description>
        </leaf>
        <leaf name="timeout">
          <type name="uint32">
            <range value="1..86400"/>
          </type>
          <units name="s"/>
          <description>
            <text>Timeout.</text>
          </description>
        </leaf>
        <leaf name="record-packet-number">
          <type name="uint32">
            <range value="1..6000"/>
          </type>
          <description>
            <text>Record packet number.</text>
          </description>
        </leaf>
        <leaf name="total-memory-size">
          <type name="uint32"/>
          <units name="MB"/>
          <description>
            <text>Record packet size.</text>
          </description>
        </leaf>
        <leaf name="obtain-packet-number">
          <type name="uint32"/>
          <description>
            <text>Obtain packet number.</text>
          </description>
        </leaf>
        <leaf name="obtain-packet-size">
          <type name="uint32"/>
          <units name="Byte"/>
          <description>
            <text>Obtain packet size.</text>
          </description>
        </leaf>
        <leaf name="saved-packet-number">
          <type name="uint32"/>
          <description>
            <text>Saved packet number.</text>
          </description>
        </leaf>
        <leaf name="saved-packet-size">
          <type name="uint32"/>
          <units name="Byte"/>
          <description>
            <text>Saved packet size.</text>
          </description>
        </leaf>
        <leaf name="delete-packet-number">
          <type name="uint32"/>
          <description>
            <text>Delete packet number.</text>
          </description>
        </leaf>
        <leaf name="delete-packet-size">
          <type name="uint32"/>
          <units name="Byte"/>
          <description>
            <text>Delete packet size.</text>
          </description>
        </leaf>
        <leaf name="first-packet-time">
          <type name="yang:date-and-time"/>
          <description>
            <text>First packet time.</text>
          </description>
        </leaf>
        <leaf name="last-packet-time">
          <type name="yang:date-and-time"/>
          <description>
            <text>Last packet time.</text>
          </description>
        </leaf>
        <leaf name="acl">
          <type name="string">
            <length value="1..63"/>
          </type>
          <description>
            <text>Acl number or name.</text>
          </description>
        </leaf>
        <leaf name="memory-packet-number">
          <type name="uint32"/>
          <description>
            <text>Memory packet number.</text>
          </description>
        </leaf>
        <leaf name="remain-time">
          <type name="uint32">
            <range value="1..86400"/>
          </type>
          <units name="s"/>
          <description>
            <text>Remain time.</text>
          </description>
        </leaf>
        <leaf name="remain-time-delete">
          <type name="uint32">
            <range value="1..86400"/>
          </type>
          <units name="s"/>
          <description>
            <text>Remain time.</text>
          </description>
        </leaf>
        <leaf name="packet-device-name">
          <type name="string">
            <length value="5..64"/>
          </type>
          <description>
            <text>Packet device name.</text>
          </description>
        </leaf>
        <leaf name="file-name">
          <type name="string">
            <length value="5..64"/>
          </type>
          <description>
            <text>File name.</text>
          </description>
        </leaf>
        <leaf name="file-length">
          <type name="uint8"/>
          <units name="MB"/>
          <default value="2"/>
          <description>
            <text>File length.</text>
          </description>
        </leaf>
        <leaf name="link-type">
          <type name="packet-header-link-type"/>
          <description>
            <text>Link type.</text>
          </description>
        </leaf>
        <leaf name="interface-name">
          <type name="leafref">
            <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
          </type>
          <description>
            <text>Interface name.</text>
          </description>
        </leaf>
        <leaf name="direction">
          <type name="direction"/>
          <description>
            <text>Direction.</text>
          </description>
        </leaf>
      </list>
    </container>
  </container>
  <rpc name="capture-packet">
    <description>
      <text>To start capture.</text>
    </description>
    <ext:node-ref value="/capture:capture/capture:capture-instances"/>
    <input>
      <leaf name="local-host">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Obtain packets sent to the CPU.</text>
        </description>
      </leaf>
      <choice name="tunnel">
        <description>
          <text>Configure the tunnel type for packet obtain.</text>
        </description>
        <case name="normal">
          <description>
            <text>Normal packet.</text>
          </description>
          <leaf name="vlan-id">
            <type name="vlan:vlan-id"/>
            <description>
              <text>Outer VLAN ID.</text>
            </description>
          </leaf>
          <leaf name="cvlan-id">
            <type name="vlan:vlan-id"/>
            <description>
              <text>Inner VLAN ID.</text>
            </description>
          </leaf>
        </case>
        <case name="vxlan">
          <description>
            <text>Vxlan packet.</text>
          </description>
          <leaf name="vxlan">
            <type name="empty"/>
            <mandatory value="true"/>
            <description>
              <text>Indicates that only VXLAN packets are captured.</text>
            </description>
          </leaf>
          <leaf name="vni-id">
            <type name="uint32">
              <range value="1..16777215"/>
            </type>
            <description>
              <text>VXLAN network identifier value.</text>
            </description>
          </leaf>
          <leaf name="tag-format">
            <type name="tag-format"/>
            <description>
              <text>Tag format for vxlan packet.</text>
            </description>
          </leaf>
        </case>
      </choice>
      <choice name="acl">
        <description>
          <text>Configure the acl for packet obtain.</text>
        </description>
        <case name="acl">
          <description>
            <text>IPv4 acl.</text>
          </description>
          <leaf name="acl-name">
            <type name="leafref">
              <path value="/acl:acl/acl:groups/acl:group/acl:identity"/>
            </type>
            <description>
              <text>Acl number or name.</text>
            </description>
          </leaf>
        </case>
        <case name="acl6">
          <description>
            <text>IPv6 acl.</text>
          </description>
          <leaf name="acl6-name">
            <type name="leafref">
              <path value="/acl:acl/acl:group6s/acl:group6/acl:identity"/>
            </type>
            <description>
              <text>Acl number or name.</text>
            </description>
          </leaf>
        </case>
      </choice>
      <leaf-list name="interface-name">
        <type name="leafref">
          <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
        </type>
        <description>
          <text>Interface name for packet obtain.</text>
        </description>
      </leaf-list>
      <leaf name="packet-number">
        <type name="uint32">
          <range value="1..5000"/>
        </type>
        <default value="100"/>
        <description>
          <text>Maximum number of packets to be captured.</text>
        </description>
      </leaf>
      <leaf name="packet-length">
        <type name="uint16">
          <range value="20..64"/>
        </type>
        <units name="Byte"/>
        <default value="64"/>
        <description>
          <text>Maximum packet length to be captured.</text>
        </description>
      </leaf>
      <leaf name="timeout">
        <type name="uint32">
          <range value="1..86400"/>
        </type>
        <units name="s"/>
        <default value="60"/>
        <description>
          <text>Timeout interval.</text>
        </description>
      </leaf>
      <leaf name="file-name">
        <type name="string">
          <length value="5..64"/>
        </type>
        <default value="capture.cap"/>
        <description>
          <text>Name of the file for saving the obtain packets.</text>
        </description>
      </leaf>
      <leaf name="clear-payload">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Sets the data content of captured packets to 0. Only the data content of TCP and UDP packets can be set to 0.</text>
        </description>
      </leaf>
      <leaf name="direction">
        <type name="direction"/>
        <description>
          <text>Packet obtain direction.</text>
        </description>
      </leaf>
      <choice name="vlan-mode">
        <description>
          <text>VLAN for packet obtain.</text>
        </description>
        <case name="vlan">
          <description>
            <text>VLAN for packet obtain.</text>
          </description>
          <leaf name="vlan-begin">
            <type name="vlan:vlan-id"/>
            <mandatory value="true"/>
            <description>
              <text>Begin VLAN ID for packet obtain.</text>
            </description>
          </leaf>
          <leaf name="vlan-end">
            <type name="vlan:vlan-id"/>
            <mandatory value="true"/>
            <description>
              <text>End VLAN ID for packet obtain.</text>
            </description>
          </leaf>
        </case>
        <case name="pe-and-ce">
          <description>
            <text>Pe and Ce VLAN for packet obtain.</text>
          </description>
          <leaf name="pe-vlan">
            <type name="vlan:vlan-id"/>
            <mandatory value="true"/>
            <description>
              <text>Pe VLAN ID for packet obtain.</text>
            </description>
          </leaf>
          <leaf name="ce-vlan-begin">
            <type name="vlan:vlan-id"/>
            <mandatory value="true"/>
            <description>
              <text>Begin inner VLAN ID for packet obtain.</text>
            </description>
          </leaf>
          <leaf name="ce-vlan-end">
            <type name="vlan:vlan-id"/>
            <mandatory value="true"/>
            <description>
              <text>End inner VLAN ID for packet obtain.</text>
            </description>
          </leaf>
        </case>
      </choice>
      <leaf name="file-size">
        <type name="uint8"/>
        <units name="MB"/>
        <default value="2"/>
        <description>
          <text>File size.</text>
        </description>
      </leaf>
      <leaf name="buffer-only">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Type buffer only.</text>
        </description>
      </leaf>
      <leaf name="overwrite">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Overwrite the buffer.</text>
        </description>
      </leaf>
    </input>
    <output>
      <leaf name="capture-index">
        <type name="capture-index"/>
        <description>
          <text>Index of the packet obtain instance.</text>
        </description>
      </leaf>
    </output>
  </rpc>
  <rpc name="stop-capture">
    <description>
      <text>To stop capure.</text>
    </description>
    <ext:node-ref value="/capture:capture/capture:capture-instances"/>
    <input>
      <choice name="mode">
        <mandatory value="true"/>
        <description>
          <text>Stop mode.</text>
        </description>
        <case name="all">
          <description>
            <text>All the packet obtain instance.</text>
          </description>
          <leaf name="all">
            <type name="empty"/>
            <description>
              <text>All the packet obtain instance.</text>
            </description>
          </leaf>
        </case>
        <case name="index">
          <description>
            <text>The packet obtain instance with a specified index.</text>
          </description>
          <leaf name="capture-index">
            <type name="capture-index"/>
            <description>
              <text>Index of the packet obtain instance.</text>
            </description>
          </leaf>
        </case>
        <case name="interface">
          <description>
            <text>The packet obtain instance with a specified interface.</text>
          </description>
          <leaf-list name="interface-name">
            <type name="leafref">
              <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
            </type>
            <min-elements value="1"/>
            <max-elements value="8"/>
            <description>
              <text>Interface name for packet obtain.</text>
            </description>
          </leaf-list>
          <leaf name="direction">
            <type name="direction"/>
            <description>
              <text>Packet obtain direction.</text>
            </description>
          </leaf>
        </case>
      </choice>
    </input>
  </rpc>
  <rpc name="free-packet-header-obtain">
    <description>
      <text>To free instance.</text>
    </description>
    <ext:node-ref value="/capture:capture/capture:capture-instances"/>
    <input>
      <leaf name="instance-id">
        <type name="uint8"/>
        <description>
          <text>Instance ID.</text>
        </description>
      </leaf>
    </input>
  </rpc>
  <notification name="capture-end-notification">
    <description>
      <text>This notification is used to report the event of the end of captureing and get the captureing file from the device to controller.</text>
    </description>
    <leaf name="capture-index">
      <type name="capture-index"/>
      <mandatory value="true"/>
      <description>
        <text>Index of the packet obtain instance.</text>
      </description>
    </leaf>
    <leaf name="esn">
      <type name="string">
        <length value="1..256"/>
      </type>
      <mandatory value="true"/>
      <description>
        <text>The device name.</text>
      </description>
    </leaf>
    <leaf name="file-name">
      <type name="string">
        <length value="1..60"/>
      </type>
      <mandatory value="true"/>
      <description>
        <text>Name of the file for saving the obtain packets.</text>
      </description>
    </leaf>
    <leaf name="type">
      <type name="string">
        <length value="1..256"/>
      </type>
      <description>
        <text>File type.</text>
      </description>
    </leaf>
    <leaf name="result">
      <type name="result"/>
      <default value="success"/>
      <description>
        <text>Packet obtain result.</text>
      </description>
    </leaf>
    <leaf name="error-code">
      <type name="uint32"/>
      <description>
        <text>Error code of the packet obtain result.</text>
      </description>
    </leaf>
    <leaf name="error-detail">
      <type name="string">
        <length value="1..256"/>
      </type>
      <description>
        <text>Error details of the packet obtain result.</text>
      </description>
    </leaf>
  </notification>
</module>
