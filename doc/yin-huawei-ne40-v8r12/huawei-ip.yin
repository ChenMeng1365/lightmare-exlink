<?xml version="1.0" encoding="UTF-8"?>
<module name="huawei-ip"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:ip="urn:huawei:yang:huawei-ip"
        xmlns:inet="urn:ietf:params:xml:ns:yang:ietf-inet-types"
        xmlns:ifm="urn:huawei:yang:huawei-ifm"
        xmlns:ext="urn:huawei:yang:huawei-extension"
        xmlns:ni="urn:huawei:yang:huawei-network-instance"
        xmlns:l3vpn="urn:huawei:yang:huawei-l3vpn">
  <namespace uri="urn:huawei:yang:huawei-ip"/>
  <prefix value="ip"/>
  <import module="ietf-inet-types">
    <prefix value="inet"/>
  </import>
  <import module="huawei-ifm">
    <prefix value="ifm"/>
  </import>
  <import module="huawei-extension">
    <prefix value="ext"/>
  </import>
  <import module="huawei-network-instance">
    <prefix value="ni"/>
  </import>
  <import module="huawei-l3vpn">
    <prefix value="l3vpn"/>
  </import>
  <organization>
    <text>Huawei Technologies Co., Ltd.</text>
  </organization>
  <contact>
    <text>Huawei Industrial Base
Bantian, Longgang
Shenzhen 518129
People's Republic of China
Website: http://www.huawei.com
Email: support@huawei.com</text>
  </contact>
  <description>
    <text>This module contains a collection of YANG definitions for
configuring IP implementations.
Copyright (C) 2019 Huawei Technologies Co., Ltd. All rights reserved.</text>
  </description>
  <revision date="2020-06-30">
    <description>
      <text>Add units attribute.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2020-02-14">
    <description>
      <text>Modify the description of nodes.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-11-10">
    <description>
      <text>Modify the must statements of IPv4 and IPv6 containers.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <revision date="2019-04-15">
    <description>
      <text>Initial revision.</text>
    </description>
    <reference>
      <text>Huawei private.</text>
    </reference>
  </revision>
  <ext:task-name value="interface-mgr"/>
  <typedef name="ipv4-address-config-type">
    <type name="enumeration">
      <enum name="main">
        <value value="1"/>
        <description>
          <text>Primary address of an interface.</text>
        </description>
      </enum>
      <enum name="sub">
        <value value="32"/>
        <description>
          <text>Secondary address of an interface.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>IPv4 address type.</text>
    </description>
  </typedef>
  <typedef name="ipv4-address-state-type">
    <type name="enumeration">
      <enum name="main">
        <value value="1"/>
        <description>
          <text>Primary address of an interface.</text>
        </description>
      </enum>
      <enum name="sub">
        <value value="32"/>
        <description>
          <text>Secondary address of an interface.</text>
        </description>
      </enum>
      <enum name="neg">
        <value value="4"/>
        <description>
          <text>Negotiated address of an interface.</text>
        </description>
      </enum>
      <enum name="unnumber">
        <value value="2"/>
        <description>
          <text>Unnumbered address of an interface.</text>
        </description>
      </enum>
      <enum name="dhcp">
        <value value="256"/>
        <description>
          <text>Unnumbered address of an interface.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>IPv4 address type.</text>
    </description>
  </typedef>
  <typedef name="ipv4-netmask">
    <type name="string">
      <length value="9..15"/>
      <pattern value="((([1-9]?[0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([1-9]?[0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))"/>
    </type>
    <description>
      <text>IPv4 mask support mask format.</text>
    </description>
  </typedef>
  <typedef name="negotiation-type">
    <type name="enumeration">
      <enum name="ppp-negotiate">
        <value value="0"/>
        <description>
          <text>PPP negotiation type.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>Negotiation address type.</text>
    </description>
  </typedef>
  <typedef name="ipv6-address-config-type">
    <type name="enumeration">
      <enum name="global">
        <value value="1"/>
        <description>
          <text>Global unicast address.</text>
        </description>
      </enum>
      <enum name="link-local">
        <value value="2"/>
        <description>
          <text>Link local address.</text>
        </description>
      </enum>
      <enum name="anycast">
        <value value="6"/>
        <description>
          <text>Anycast address.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>IPv6 address type.</text>
    </description>
  </typedef>
  <typedef name="ipv6-address-state-type">
    <type name="enumeration">
      <enum name="global">
        <value value="1"/>
        <description>
          <text>Global unicast address.</text>
        </description>
      </enum>
      <enum name="link-local">
        <value value="2"/>
        <description>
          <text>Link local address.</text>
        </description>
      </enum>
      <enum name="auto-link-local">
        <value value="3"/>
        <description>
          <text>Auto link local address.</text>
        </description>
      </enum>
      <enum name="anycast">
        <value value="6"/>
        <description>
          <text>Anycast address.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>IPv6 address type.</text>
    </description>
  </typedef>
  <typedef name="ipv6-address-algorithm-type">
    <type name="enumeration">
      <enum name="none">
        <value value="0"/>
        <description>
          <text>None.</text>
        </description>
      </enum>
      <enum name="cga">
        <value value="1"/>
        <description>
          <text>Cga type.</text>
        </description>
      </enum>
      <enum name="eui64">
        <value value="2"/>
        <description>
          <text>EUI-64 type.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>IPv6 address algorithm type.</text>
    </description>
  </typedef>
  <typedef name="ipv6-status-type">
    <type name="enumeration">
      <enum name="preferred">
        <value value="1"/>
        <description>
          <text>This is a valid address that can appear as the destination or source address of a packet.</text>
        </description>
      </enum>
      <enum name="inaccessible">
        <value value="4"/>
        <description>
          <text>The address is not accessible because the interface to which this address is assigned is not operational.</text>
        </description>
      </enum>
      <enum name="unknown">
        <value value="5"/>
        <description>
          <text>The status cannot be determined for some reason.</text>
        </description>
      </enum>
      <enum name="tentative">
        <value value="6"/>
        <description>
          <text>The uniqueness of the address on the link is being verified. Addresses in this state should not be used for general communication and should only be used to determine the uniqueness of the address.</text>
        </description>
      </enum>
      <enum name="duplicate">
        <value value="7"/>
        <description>
          <text>The address has been determined to be non-unique on the link and so must not be used.</text>
        </description>
      </enum>
    </type>
    <description>
      <text>The status of an address.</text>
    </description>
  </typedef>
  <augment target-node="/ifm:ifm/ifm:interfaces/ifm:interface">
    <description>
      <text>Policies for selecting source and destination IPv6 addresses and parameters for configuring IP on interfaces.</text>
    </description>
    <container name="ipv4">
      <must condition="/ni:network-instance/ni:instances/ni:instance[ni:name=current()/../ifm:vrf-name]/l3vpn:afs/l3vpn:af[l3vpn:type='ipv4-unicast']"/>
      <description>
        <text>Configure IPv4 addresses.</text>
      </description>
      <choice name="address">
        <description>
          <text>The IPv4 address can be specified as negotiated or unnumbered or ordinarily address.</text>
        </description>
        <case name="common-address">
          <description>
            <text>Configure address.</text>
          </description>
          <container name="addresses">
            <must condition="count(address)=0 or count(address[type='main'])=1"/>
            <description>
              <text>List of common addresses. The IPv4 address of the DCN interface cannot be created, modified, or deleted.</text>
            </description>
            <list name="address">
              <key value="ip"/>
              <description>
                <text>Configure IPv4 address.</text>
              </description>
              <leaf name="ip">
                <type name="inet:ipv4-address-no-zone"/>
                <description>
                  <text>IPv4 address.</text>
                </description>
              </leaf>
              <leaf name="mask">
                <type name="ipv4-netmask"/>
                <mandatory value="true"/>
                <description>
                  <text>IPv4 address mask.</text>
                </description>
              </leaf>
              <leaf name="type">
                <type name="ipv4-address-config-type"/>
                <mandatory value="true"/>
                <description>
                  <text>IPv4 address type.</text>
                </description>
              </leaf>
            </list>
          </container>
        </case>
        <case name="unnumbered-address">
          <description>
            <text>Unnumbered address.</text>
          </description>
          <container name="unnumbered-address">
            <description>
              <text>Configure unnumbered interface. The address borrowing relationship of the DCN interface cannot be created, modified, or deleted.</text>
            </description>
            <leaf name="unnumbered-if-name">
              <type name="leafref">
                <path value="/ifm:ifm/ifm:interfaces/ifm:interface/ifm:name"/>
              </type>
              <must condition="(../../../ifm:name!=../unnumbered-if-name) and (/ifm:ifm/ifm:interfaces/ifm:interface[ifm:name=current()]/ifm:vrf-name = ../../../ifm:vrf-name)"/>
              <mandatory value="true"/>
              <description>
                <text>Name of an unnumbered interface.</text>
              </description>
            </leaf>
          </container>
        </case>
        <case name="negotiate-address">
          <description>
            <text>Negotiate address.</text>
          </description>
          <container name="negotiation-address">
            <description>
              <text>Configure negotiate address.</text>
            </description>
            <leaf name="negotiation-type">
              <type name="negotiation-type"/>
              <mandatory value="true"/>
              <description>
                <text>Enable negotiation address on interface.</text>
              </description>
            </leaf>
          </container>
        </case>
      </choice>
      <container name="state">
        <config value="false"/>
        <description>
          <text>Operational state of IPv4 addresses.</text>
        </description>
        <container name="addresses">
          <description>
            <text>List of addresses.</text>
          </description>
          <list name="address">
            <key value="ip"/>
            <description>
              <text>Operational state of IPv4 address.</text>
            </description>
            <leaf name="ip">
              <type name="inet:ipv4-address-no-zone"/>
              <description>
                <text>IPv4 address.</text>
              </description>
            </leaf>
            <leaf name="mask">
              <type name="ipv4-netmask"/>
              <description>
                <text>IPv4 address mask.</text>
              </description>
            </leaf>
            <leaf name="type">
              <type name="ipv4-address-state-type"/>
              <description>
                <text>IPv4 address type.</text>
              </description>
            </leaf>
            <leaf name="is-block">
              <type name="boolean"/>
              <description>
                <text>IPv4 address is blocked or not.</text>
              </description>
            </leaf>
          </list>
        </container>
        <container name="gateways">
          <config value="false"/>
          <description>
            <text>List of gateway addresses.</text>
          </description>
          <list name="gateway">
            <key value="gateway"/>
            <description>
              <text>Operational state of gateway addresses.</text>
            </description>
            <leaf name="gateway">
              <type name="inet:ipv4-address"/>
              <description>
                <text>Gateway of interface.</text>
              </description>
            </leaf>
          </list>
        </container>
      </container>
    </container>
    <container name="ipv6">
      <presence value="Enable/disable the IPv6 capability on an interface."/>
      <description>
        <text>Enable/disable the IPv6 capability on an interface.</text>
      </description>
      <leaf name="mtu6">
        <type name="uint32">
          <range value="0..50000"/>
        </type>
        <units name="Byte"/>
        <ext:dynamic-default/>
        <description>
          <text>IPv6 maximum transmission unit of an interface.
Special explanation:
Range: The server may restrict the allowed values for this leaf, depending on the interface's type.</text>
        </description>
      </leaf>
      <leaf name="spread-mtu-flag">
        <type name="boolean"/>
        <default value="false"/>
        <description>
          <text>Enable/disable the function of spreading the IPv6 MTU of main interface to subinterface.</text>
        </description>
      </leaf>
      <leaf name="auto-link-local">
        <type name="boolean"/>
        <must condition="../auto-link-local='false' or (../auto-link-local='true' and /ni:network-instance/ni:instances/ni:instance[ni:name=current()/../../ifm:vrf-name]/l3vpn:afs/l3vpn:af[l3vpn:type='ipv6-unicast'])"/>
        <default value="false"/>
        <description>
          <text>Enable/disable an interface with the auto linklocal address function.</text>
        </description>
      </leaf>
      <choice name="address">
        <description>
          <text>IPv6 address configurations.</text>
        </description>
        <case name="common-address">
          <description>
            <text>Configure address.</text>
          </description>
          <container name="addresses">
            <must condition="/ni:network-instance/ni:instances/ni:instance[ni:name=current()/../../ifm:vrf-name]/l3vpn:afs/l3vpn:af[l3vpn:type='ipv6-unicast']"/>
            <description>
              <text>List of IPv6 addresses.</text>
            </description>
            <list name="address">
              <key value="ip"/>
              <description>
                <text>Configure IPv6 address.</text>
              </description>
              <leaf name="ip">
                <type name="inet:ipv6-address-no-zone"/>
                <description>
                  <text>IPv6 address.</text>
                </description>
              </leaf>
              <leaf name="prefix-length">
                <type name="uint32">
                  <range value="1..128"/>
                </type>
                <mandatory value="true"/>
                <description>
                  <text>Length of the IPv6 address prefix.</text>
                </description>
              </leaf>
              <leaf name="type">
                <type name="ipv6-address-config-type"/>
                <mandatory value="true"/>
                <description>
                  <text>IPv6 address type.</text>
                </description>
              </leaf>
              <leaf name="algorithm-type">
                <type name="ipv6-address-algorithm-type"/>
                <must condition="(../type='global' and (../algorithm-type='none' or ../algorithm-type='cga' or ../algorithm-type='eui64') ) or (../type='link-local' and (../algorithm-type='none' or ../algorithm-type='cga') ) or (../type='anycast' and ../algorithm-type='none')"/>
                <default value="none"/>
                <description>
                  <text>Address algorithm type.</text>
                </description>
              </leaf>
            </list>
          </container>
        </case>
      </choice>
      <container name="nd-prefixs">
        <must condition="(count(nd-prefix)&gt; 0 and /ni:network-instance/ni:instances/ni:instance[ni:name=current()/../../ifm:vrf-name]/l3vpn:afs/l3vpn:af[l3vpn:type='ipv6-unicast']) or (count(nd-prefix)= 0)"/>
        <description>
          <text>List of nd prefix.</text>
        </description>
        <list name="nd-prefix">
          <key value="prefix"/>
          <description>
            <text>Configure nd prefix.</text>
          </description>
          <leaf name="prefix">
            <type name="inet:ipv6-address-no-zone"/>
            <description>
              <text>IPv6 address of the prefix.</text>
            </description>
          </leaf>
          <leaf name="prefix-len">
            <type name="int32">
              <range value="0..128"/>
            </type>
            <mandatory value="true"/>
            <description>
              <text>Length of the prefix address.</text>
            </description>
          </leaf>
          <leaf name="valid-lifetime">
            <type name="uint32">
              <range value="0..4294967295"/>
            </type>
            <units name="s"/>
            <must condition="(../valid-lifetime&gt;=../preferred-lifetime)"/>
            <mandatory value="true"/>
            <description>
              <text>Valid life time.</text>
            </description>
          </leaf>
          <leaf name="preferred-lifetime">
            <type name="uint32">
              <range value="0..4294967295"/>
            </type>
            <units name="s"/>
            <must condition="(../preferred-lifetime&lt;=../valid-lifetime)"/>
            <mandatory value="true"/>
            <description>
              <text>Preferred life time.</text>
            </description>
          </leaf>
          <leaf name="auto-flag">
            <type name="boolean"/>
            <default value="true"/>
            <description>
              <text>Enable/disable the autonomous address-configuration.</text>
            </description>
          </leaf>
          <leaf name="on-link-flag">
            <type name="boolean"/>
            <default value="true"/>
            <description>
              <text>Enable/disable the on-link flag.</text>
            </description>
          </leaf>
        </list>
      </container>
      <container name="state">
        <config value="false"/>
        <description>
          <text>Operational state of IPv6 addresses.</text>
        </description>
        <leaf name="mtu6">
          <type name="uint32">
            <range value="0..50000"/>
          </type>
          <units name="Byte"/>
          <description>
            <text>IPv6 maximum transmission unit of an interface.
Special explanation:
Range: The server may restrict the allowed values for this leaf, depending on the interface's type.</text>
          </description>
        </leaf>
        <container name="addresses">
          <description>
            <text>List of IPv6 addresses.</text>
          </description>
          <list name="address">
            <key value="ip"/>
            <description>
              <text>Operational state of IPv6 addresses.</text>
            </description>
            <leaf name="ip">
              <type name="inet:ipv6-address-no-zone"/>
              <description>
                <text>IPv6 address.</text>
              </description>
            </leaf>
            <leaf name="prefix-length">
              <type name="uint32">
                <range value="1..128"/>
              </type>
              <description>
                <text>Length of the IPv6 address prefix.</text>
              </description>
            </leaf>
            <leaf name="type">
              <type name="ipv6-address-state-type"/>
              <description>
                <text>IPv6 address type.</text>
              </description>
            </leaf>
            <leaf name="algorithm-type">
              <type name="ipv6-address-algorithm-type"/>
              <description>
                <text>Address algorithm type.</text>
              </description>
            </leaf>
            <leaf name="collision-count">
              <type name="uint8">
                <range value="0..3"/>
              </type>
              <description>
                <text>Number of IPv6 address collisions.</text>
              </description>
            </leaf>
            <leaf name="is-block">
              <type name="boolean"/>
              <description>
                <text>IPv6 address is blocked or not.</text>
              </description>
            </leaf>
            <leaf name="status">
              <type name="ipv6-status-type"/>
              <description>
                <text>IPv6 address status.</text>
              </description>
            </leaf>
          </list>
        </container>
      </container>
    </container>
  </augment>
</module>
